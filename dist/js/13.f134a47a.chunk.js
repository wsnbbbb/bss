(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1552:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Je}));a(174);var n=a(107),o=a.n(n),r=(a(726),a(1735)),i=a.n(r),c=(a(175),a(66)),l=a.n(c),s=(a(47),a(17)),u=a.n(s),d=(a(132),a(35)),m=a.n(d),f=a(15),p=a.n(f),h=a(19),g=a.n(h),y=a(6),b=a.n(y),v=a(20),S=a.n(v),w=a(21),k=a.n(w),E=a(13),C=a.n(E),O=a(33),N=a.n(O),D=a(2),R=a.n(D),P=a(185),I=a.n(P),x=a(311),L=a.n(x),j=(a(65),a(25)),M=a.n(j),A=a(0),U=a.n(A),T=a(1),z=a.n(T),B=a(1591),F={name:"warning",theme:"outlined",icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]}},V=a(69),G=function(e,t){return A.createElement(V.a,Object.assign({},e,{ref:t,icon:F}))};G.displayName="WarningOutlined";var q=A.forwardRef(G),K={name:"lock",theme:"outlined",icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]}},W=function(e,t){return A.createElement(V.a,Object.assign({},e,{ref:t,icon:K}))};W.displayName="LockOutlined";var H,J,$,Q=A.forwardRef(W),X=a(1587),Y=a(23),Z=(a(1730),a(18)),ee=a(9),te=a(52),ae=a(26),ne=(a(724),a(417)),oe=a.n(ne),re=(a(58),a(11)),ie=a.n(re),ce=(a(98),a(55)),le=a.n(ce),se=(a(60),a(12)),ue=a.n(se),de=a(5),me=a.n(de),fe=a(28),pe=a(153),he=a(16),ge=a.n(he);function ye(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function be(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(a),!0).forEach((function(t){R()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ye(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ve(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Se,we,ke,Ee=ue.a.Item,Ce=le.a.TextArea,Oe=ie.a.Option,Ne=Object(Y.c)(($=J=function(e){S()(n,e);var t,a=(t=n,function(){var e,a=C()(t);if(ve()){var n=C()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return k()(this,e)});function n(e){var t;return p()(this,n),t=a.call(this,e),R()(b()(t),"formRefAdd",U.a.createRef()),R()(b()(t),"onResetSearch",(function(){t.formRefAdd.current.resetFields()})),R()(b()(t),"onClose",(function(){t.props.onClose()})),t.selectAreaNode={},t.state={modalLoading:!1,modalShowArea:!1},t}return g()(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){}},{key:"onFinish",value:function(e){var t=this.props.operateType;if("see"!==t){var a=e.amp+e.voltageUnit;delete e.voltageUnit,e.amp=a;e.localInfo;var n=be({},L()(e,["localInfo"]),{districtId:this.selectAreaNode.id});"up"===t&&(n=be({},n,{version:this.props.data.version})),this.props.onOk(n)}else this.props.onClose()}},{key:"render",value:function(){var e=this,t=this.props,a=t.operateType,n=t.modalLoading,r=t.data,i=t.visible;"see"!==a&&"up"!==a||(r.beginDate?r.beginDate=ge()(r.beginDate):r.beginDate=null,r.endDate?r.endDate=ge()(r.endDate):r.endDate=null);return U.a.createElement("div",null,U.a.createElement(M.a,{title:{add:"新增机柜",up:"修改机柜",see:"查看机柜"}[a],maskClosable:!1,width:"60%",destroyOnClose:!0,footer:null,onCancel:this.props.onClose,visible:i,zIndex:1032},U.a.createElement(o.a,{tip:"Loading...",spinning:n},U.a.createElement(ue.a,{name:"form_in_modal",ref:this.formRefAdd,className:"g-modal-field",onFinish:function(t){e.onFinish(t)},validateMessages:{required:"'${name}' 是必选字段"},initialValues:r},U.a.createElement(Ee,N()({label:"机柜名称",name:"name",rules:[{required:!0,message:"请输入"},{max:15,message:"最多输入15个字符"}]},fe.b),U.a.createElement(le.a,{type:"text",placeholder:"请输入",disabled:"see"===a})),"add"!=a&&U.a.createElement(Ee,N()({label:"物理位置码",name:"physicsLocationCode"},fe.b),U.a.createElement(le.a,{type:"text",disabled:!0})),U.a.createElement(Ee,N()({label:"行列"},fe.b),U.a.createElement(Ee,{name:"row",rules:[{required:!0,pattern:pe.a.num,message:"请输入整数"}],style:{display:"inline-block",width:150}},U.a.createElement(le.a,{prefix:"行:",disabled:!0})),U.a.createElement(Ee,{name:"coulmn",rules:[{required:!0,pattern:pe.a.num,message:"请输入整数"}],style:{display:"inline-block",width:150}},U.a.createElement(le.a,{disabled:!0,prefix:"列:"}))),U.a.createElement(Ee,N()({label:"规格"},fe.b),U.a.createElement(Ee,{name:"spec",rules:[{required:!0,message:"请输入"},{max:14,message:"最多输入14个字符"}]},U.a.createElement(le.a,{placeholder:"示例：600*800",disabled:"see"===a}))),U.a.createElement(Ee,N()({label:"机柜属性",name:"attribute",rules:[{required:!0,message:"请输入"}]},fe.b),U.a.createElement(ie.a,{disabled:"see"===a},me.a.map(ae.a.cabinet_attribute,(function(e,t){return U.a.createElement(Oe,{value:parseInt(t),key:t}," ",e," ")})))),U.a.createElement(Ee,N()({label:"承重",name:"bearing",rules:[{required:!0,message:"请输入"},{max:10,message:"最多输入10个字符"}]},fe.b),U.a.createElement(le.a,{suffix:"kg",disabled:"see"===a})),U.a.createElement(Ee,N()({label:"总U位数",name:"us",rules:[{required:!0,pattern:pe.a.num,message:"请输入数字"}]},fe.b),U.a.createElement(le.a,{disabled:"see"===a||"up"===a})),U.a.createElement(Ee,N()({label:U.a.createElement("span",{className:"required"},"默认电力")},fe.b,{rules:[{required:!0,message:"请输入"},{max:10,message:"最多输入10个字符"},{pattern:pe.a.float,message:"请输入数字"}]}),U.a.createElement(Ee,{name:"amp",style:{display:"inline-block",width:200},rules:[{required:!0,message:"请输入"},{max:10,message:"最多输入10个字符"},{pattern:pe.a.float,message:"请输入数字"}]},U.a.createElement(le.a,{style:{width:190},disabled:"see"===a})),U.a.createElement(Ee,{name:"voltageUnit",style:{display:"inline-block",width:100},rules:[{required:!0,message:"请选择"}]},U.a.createElement(ie.a,{style:{width:130},disabled:"see"===a},U.a.createElement(Oe,{value:"A"},"A"),U.a.createElement(Oe,{value:"KVA"},"KVA"),U.a.createElement(Oe,{value:"KW"},"KW")))),U.a.createElement(Ee,N()({label:"电压",name:"voltage"},fe.b,{rules:[{required:!0,message:"请输入"},{max:10,message:"最多输入10个字符"}]}),U.a.createElement(le.a,{suffix:"V",disabled:"see"===a})),U.a.createElement(Ee,N()({label:"机柜PDU情况",name:"pdu"},fe.b,{rules:[{required:!0,message:"请输入"},{max:50,message:"最多输入50个字符"}]}),U.a.createElement(le.a,{disabled:"see"===a})),U.a.createElement(Ee,N()({label:"开始计费时间",name:"beginDate"},fe.b),U.a.createElement(oe.a,{style:{width:"100%"},disabled:"see"===a})),U.a.createElement(Ee,N()({label:"合同到期时间",name:"endDate"},fe.b),U.a.createElement(oe.a,{style:{width:"100%"},disabled:"see"===a})),U.a.createElement(Ee,N()({label:"备注",name:"remark"},fe.b,{rules:[{max:250,message:"最多输入250个字符"}]}),U.a.createElement(Ce,{autoSize:{minRows:5},placeholder:"请输入",disabled:"see"===a})),"see"!==a&&U.a.createElement("div",{className:"actions-btn"},U.a.createElement(u.a,{htmlType:"submit",className:"action-btn ok"},"确认提交"),U.a.createElement(u.a,{onClick:this.onResetSearch,className:"action-btn ok"},"重置"),U.a.createElement(u.a,{onClick:this.onClose,className:"action-btn ok"},"取消"))))))}}]),n}(U.a.Component),R()(J,"propTypes",{location:z.a.any,history:z.a.any,operateType:z.a.string,data:z.a.any,visible:z.a.bool,modalLoading:z.a.bool,onOk:z.a.func,onClose:z.a.func}),H=$))||H,De=a(1643),Re=(a(152),a(78)),Pe=a.n(Re),Ie=a(99);function xe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var _e,Le,je,Me=Object(Ie.g)(Se=Object(Y.c)((ke=we=function(e){S()(n,e);var t,a=(t=n,function(){var e,a=C()(t);if(xe()){var n=C()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return k()(this,e)});function n(e){var t;return p()(this,n),(t=a.call(this,e)).selectedRowKeys=[],t.searchFormRef=U.a.createRef(),t.searchCondition={},t.state={lists:[],loading:!1,showModal:!1,pageNum:1,page_size:20,total:0,pages:0,selectedRowKeys:[]},t}return g()(n,[{key:"componentDidMount",value:function(){this.onGetMListData()}},{key:"onGetMListData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=me.a.assign({},this.searchCondition,{cabinetId:this.props.record.id,deviceType:0},t);this.setState({loading:!0}),Z.a.get("".concat(BSS_ADMIN_URL,"/api/product/network/devices"),{params:ee.a.clearNull(a)}).then((function(t){if(t=t.data,ee.a.hasStatusOk(t)){var a=t.data.records;e.setState({lists:a,total:t.data.total,pages:t.data.pages,pageNum:t.data.current})}else ee.a.dealFail(t);e.setState({loading:!1})})).catch((function(){e.setState({loading:!1})}))}},{key:"makeColumns",value:function(){return[{title:"设备名称",dataIndex:"deviceName",key:"deviceName"},{title:"区域",dataIndex:"fullLocationName",key:"fullLocationName"},{title:"机柜",dataIndex:"cabinetName",key:"cabinetName"},{title:"物理位置码",dataIndex:"locationCode",key:"PhyLocationCode"},{title:"管理IP",dataIndex:"ip",key:"ip"},{title:"起始U位",dataIndex:"startubat",key:"startubat"},{title:"占用U位",dataIndex:"uw",key:"uw"},{title:"端口数量",dataIndex:"num",key:"num"},{title:"设备类型",dataIndex:"deviceType",key:"deviceType",render:function(e,t){return ae.f.re_facility[e]}}]}},{key:"render",value:function(){var e=this,t=this.state,a=t.lists,n=t.loading,o=t.total,r=t.page_size,i={current:t.pageNum,total:o,size:r,defaultPageSize:r,onChange:function(t,a){return e.onGetMListData({page:t,pageSize:a})},onShowSizeChange:function(t,a){return e.onGetMListData({page:t,pageSize:a})},showTotal:function(e){return"共".concat(e,"条")}};return U.a.createElement("main",null,U.a.createElement("div",{className:"c-operate"},U.a.createElement(u.a,{size:"middle",onClick:function(){return e.onGetMListData()},className:"actions-btn"},"刷新")),U.a.createElement("div",{className:"g-table"},U.a.createElement(Pe.a,{columns:this.makeColumns(),rowKey:function(e){return e.id},loading:n,dataSource:a,pagination:i,size:"small"})))}}]),n}(U.a.Component),R()(we,"propTypes",{location:z.a.any,history:z.a.any,match:z.a.any,defaultData:z.a.any,onOk:z.a.func,onClose:z.a.func}),Se=ke))||Se)||Se,Ae=a(1599),Ue=a(1543),Te=a(1924),ze=a(1923);function Be(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Fe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ve(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(a),!0).forEach((function(t){R()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ge(e){if(!e)return[void 0,void 0];var t,a,n=e.search(/KVA|KW|A/i);return-1!=n&&(t=e.slice(0,n),a=e.slice(n)),[t,a]}var qe="DragbleBodyRow1",Ke=M.a.confirm,We=function(e){var t=e.index,a=e.moveRow,n=e.className,o=e.style,r=(e.record,L()(e,["index","moveRow","className","style","record"])),i=U.a.useRef(),c=Object(Te.a)({accept:qe,collect:function(e){var a=(e.getItem()||{}).index;return a===t?{}:{begainItem:e.getItem(),isOver:e.isOver(),dropClassName:a<t?" drop-over-downward":" drop-over-upward"}},drop:function(e){a(e)}}),l=I()(c,2),s=l[0],u=s.isOver,d=s.dropClassName;return(0,l[1])(i),U.a.createElement("td",N()({ref:i,className:"".concat(n).concat(u?d:""),style:Ve({cursor:"move"},o)},r))},He=function(e){var t=e.index,a=(e.moveRow,e.className),n=e.style,o=e.record,r=L()(e,["index","moveRow","className","style","record"]),i=U.a.useRef(),c=Object(ze.a)({item:{type:qe,index:t,record:o},collect:function(e){return{isDragging:e.isDragging()}},beginDrag:function(e,t,a){return{record:e.record}}});return(0,I()(c,2)[1])(i),U.a.createElement("td",N()({ref:i,className:"".concat(a),style:Ve({cursor:"move"},n)},r))},Je=Object(Y.c)((je=Le=function(e){S()(n,e);var t,a=(t=n,function(){var e,a=C()(t);if(Be()){var n=C()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return k()(this,e)});function n(e){var t;return p()(this,n),t=a.call(this,e),R()(b()(t),"searchFormRef",U.a.createRef()),R()(b()(t),"makeCabinetMap",(function(e,t,a){for(var n={},o=[],r=[],i=1;i<=a;i++)r.push(i);for(var c=1;c<=t;c++)o.push(c);return _.map(e,(function(e){var t="".concat(e.row,"-").concat(e.coulmn);n[t]=e})),{cabinetMap:n,rowArr:o,colArr:r}})),R()(b()(t),"moveRow",(function(e,a){if(e.record.row==a.row&&e.record.coulmn==a.coulmn)return!1;t.setState({loading:!0}),Z.a.post("".concat(BSS_ADMIN_URL,"/api/product/cabinet/").concat(e.record.id,"/move"),Ve({},a,{version:e.record.version})).then((function(e){e=e.data,ee.a.hasStatusOk(e)?(t.setState({loading:!1}),ee.a.auto_close_result("ok","操作成功"),t.onGetListData()):ee.a.dealFail(e),t.setState({loading:!1})})).catch((function(){t.setState({loading:!1})}))})),R()(b()(t),"onLock",(function(e){var a=e.lockStatus,n={lockStatus:a=0===a?1:0,version:e.version};t.setState({loading:!0}),Z.a.post("".concat(BSS_ADMIN_URL,"/api/product/cabinet/").concat(e.id,"/lock"),ee.a.clearNull(n)).then((function(e){2e4===(e=e.data).code?(t.onGetListData(),m.a.success("修改状态成功"),t.setState({loading:!1})):(m.a.error(e.data),t.setState({loading:!1}))})).catch((function(){t.setState({loading:!1})}))})),t.state={searchParam:{},lists:[],loading:!1,cabinetMap:{},rowArr:[],colArr:[],operateType:"add",modalShow:!1,modalLoading:!1,nowDataCabinet:{},nowCabinetId:"",modalShowUBit:!1,modalLoadingUBit:!1,regionInfo:{},changeData:{},showChang:!1},t}return g()(n,[{key:"componentDidMount",value:function(){}},{key:"onGetListData",value:function(e){var t=this;if(!(e=e||this.state.regionInfo).regionId||!e.record.row||!e.record.col)return!1;var a=e.record.row,n=e.record.col,o=_.assign({},{regionId:e.regionId},this.state.searchParam);this.setState({loading:!0,regionInfo:e}),Z.a.get("".concat(BSS_ADMIN_URL,"/api/product/cabinet"),{params:o}).then((function(e){if(e=e.data,ee.a.hasStatusOk(e)){var o=t.makeCabinetMap(e.data,a,n);t.setState({lists:e.records,cabinetMap:o.cabinetMap,rowArr:o.rowArr,colArr:o.colArr})}else ee.a.dealFail(e);t.setState({loading:!1})})).catch((function(){t.setState({loading:!1})}))}},{key:"onSearch",value:function(e,t){console.log(t),this.obj=t.record,this.onGetListData(t)}},{key:"onModalShow",value:function(e,t){if("add"==e){var a=Ge(this.obj.amp),n={row:t.row,coulmn:t.coulmn,name:null,us:this.obj.cabinetUCount,spec:this.obj.spec,voltage:this.obj.voltage,amp:a[0],voltageUnit:a[1],power:null,bearing:this.obj.bearing,pdu:this.obj.pdu,attribute:null,locationId:null,regionId:null,remark:null,type:null,status:null,beginDate:null,endData:null};this.setState({modalShow:!0,nowDataCabinet:n,operateType:e})}else this.getDetail(t.id,e)}},{key:"onModalOk",value:function(e){var t=this;if(this.setState({modalLoading:!0}),"add"==this.state.operateType){var a=Ve({},e,{districtId:this.state.regionInfo.districtId,houseId:this.state.regionInfo.houseId,regionId:this.state.regionInfo.regionId,type:0});Z.a.post("".concat(BSS_ADMIN_URL,"/api/product/cabinet/add"),ee.a.clearNull(a)).then((function(e){e=e.data,ee.a.hasStatusOk(e)?(t.setState({modalLoading:!1,modalShow:!1}),t.onGetListData(),ee.a.auto_close_result("ok","操作成功")):(t.setState({modalShow:!1}),ee.a.dealFail(e)),t.setState({modalLoading:!1})})).catch((function(){t.setState({modalShow:!1}),t.setState({modalLoading:!1})}))}else{var n=ee.a.clearNull(Ve({},this.state.nowDataCabinet,{},e));Z.a.put("".concat(BSS_ADMIN_URL,"/api/product/cabinet/").concat(this.state.nowDataCabinet.id,"/update"),ee.a.clearNull(n)).then((function(e){e=e.data,ee.a.hasStatusOk(e)?(t.setState({page:1,modalLoading:!1,modalShow:!1}),t.onGetListData(),ee.a.auto_close_result("ok","操作成功")):(t.setState({modalShow:!1}),ee.a.dealFail(e)),t.setState({modalLoading:!1})})).catch((function(){t.setState({modalShow:!1}),t.setState({modalLoading:!1})}))}}},{key:"getDetail",value:function(e,t){var a=this;Z.a.get("".concat(BSS_ADMIN_URL,"/api/product/cabinet/").concat(e,"/get")).then((function(e){if(e=e.data,ee.a.hasStatusOk(e)){var n=Ge(e.data.amp);console.log(e.data),a.setState({nowDataCabinet:Ve({},e.data,{amp:n[0],voltageUnit:n[1]}),modalShow:!0,modalLoading:!1,operateType:t})}else ee.a.dealFail(e)})).catch((function(){}))}},{key:"setBarrier",value:function(e){var t=this;Ke({icon:U.a.createElement(B.a,null),content:"确认添加障碍物",onOk:function(){var a={name:"障碍物",attribute:6,coulmn:e.coulmn,row:e.row,us:0,type:1,regionId:t.state.regionInfo.regionId};t.setState({loading:!0}),Z.a.post("".concat(BSS_ADMIN_URL,"/api/product/cabinet/add"),a).then((function(e){e=e.data,ee.a.hasStatusOk(e)?(ee.a.auto_close_result("ok","操作成功"),t.onGetListData()):(ee.a.dealFail(e),t.setState({loading:!1}))})).catch((function(){t.setState({loading:!1})}))},onCancel:function(){console.log("Cancel")}})}},{key:"removeBarrier",value:function(e){var t=this;Ke({icon:U.a.createElement(B.a,null),content:"确认移除障碍物",onOk:function(){t.setState({loading:!0}),Z.a.delete("".concat(BSS_ADMIN_URL,"/api/product/cabinet/").concat(e.id,"/delete")).then((function(e){e=e.data,ee.a.hasStatusOk(e)?(ee.a.auto_close_result("ok","操作成功"),t.onGetListData()):(ee.a.dealFail(e),t.setState({loading:!1}))})).catch((function(){t.setState({loading:!1})}))},onCancel:function(){console.log("Cancel")}})}},{key:"setStatus",value:function(e,t,a){var n=this;Ke({icon:U.a.createElement(B.a,null),content:"确认修改状态为".concat(t),onOk:function(){n.setState({loading:!0}),Z.a.put("".concat(BSS_ADMIN_URL,"/api/product/cabinet/").concat(a.id,"/update"),{status:e,version:a.version}).then((function(e){e=e.data,ee.a.hasStatusOk(e)?(ee.a.auto_close_result("ok","操作成功"),n.onGetListData()):(ee.a.dealFail(e),n.setState({loading:!1}))})).catch((function(){n.setState({loading:!1})}))},onCancel:function(){console.log("Cancel")}})}},{key:"onModalClose",value:function(){this.setState({modalShow:!1})}},{key:"onDel",value:function(e){var t=this;Ke({icon:U.a.createElement(B.a,null),content:"确认要删除这条数据吗？",onOk:function(){t.setState({loading:!0}),Z.a.delete("".concat(BSS_ADMIN_URL,"/api/product/cabinet/").concat(e,"/delete")).then((function(e){e=e.data,ee.a.hasStatusOk(e)?(ee.a.auto_close_result("ok","操作成功"),t.onGetListData()):(ee.a.dealFail(e),t.setState({loading:!1}))})).catch((function(){t.setState({loading:!1})}))},onCancel:function(){console.log("Cancel")}})}},{key:"onModalShowUBit",value:function(e){this.setState({modalShowUBit:!0,nowCabinetId:e.id,nowDataCabinet:e})}},{key:"onShowChange",value:function(e){this.setState({showChang:!0,changeData:e})}},{key:"onCancel",value:function(){this.setState({showChang:!1})}},{key:"onModalCloseUBit",value:function(){this.setState({modalShowUBit:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.cabinetMap,r=t.rowArr,c=t.colArr;return U.a.createElement("main",{className:"mian"},U.a.createElement("div",{className:"clearfix"},U.a.createElement("div",{className:"g-search",style:{width:400,float:"left"}},U.a.createElement(Ae.a,{defaultKey:"",onSearch:function(t,a){e.onSearch(t,a)}})),U.a.createElement("div",{className:"g-operate",style:{width:200,float:"right"}},te.a.hasPermission("cabinet-u-edit")&&U.a.createElement(u.a,{className:"actions-btn",size:"middle",onClick:function(){ee.a.download("".concat(BSS_ADMIN_URL,"/api/product/cabinet/download/template"))}},"下载导入模板"),te.a.hasPermission("cabinet-u-edit")&&U.a.createElement(De.a,{filetext:"上传模板",url:"".concat(BSS_ADMIN_URL,"/api/product/cabinet/import/template")},U.a.createElement(u.a,{className:"actions-btn",size:"middle"},"导入")))),U.a.createElement("div",{className:"region-map"},U.a.createElement("div",{className:"region-map-head clearfix"},U.a.createElement("div",{style:{float:"right"}},_.map(ae.a.cabinet_status,(function(e,t){return U.a.createElement(l.a,{key:t,color:e.color},e.text)})))),U.a.createElement("div",{className:"region-map-body"},U.a.createElement(o.a,{spinning:a},U.a.createElement("table",null,U.a.createElement("tbody",null,_.map(r,(function(t){return U.a.createElement("tr",{key:t},_.map(c,(function(a){var o=t+"-"+a,r=n[o];return r&&1===r.type?U.a.createElement(i.a,{title:"障碍物",trigger:"click",placement:"right",content:U.a.createElement("ul",{className:"opt-tooltip-box"},te.a.hasPermission("cabinet-u-edit")&&U.a.createElement("li",{onClick:function(){e.removeBarrier(r)},className:"tooltip-inner",key:o},"移除"))},U.a.createElement("td",{className:"td-box"},U.a.createElement("div",{className:"box box-barrier",title:"障碍物"},U.a.createElement(q,null)))):r&&0===r.type&&te.a.hasPermission("cabinet-u-view")?U.a.createElement(He,{key:o,className:"td-box",record:r,moveRow:function(t){e.moveRow(t,r)}},U.a.createElement(i.a,{trigger:"click",placement:"right",content:U.a.createElement("ul",{className:"opt-tooltip-box"},te.a.hasPermission("cabinet-u-view")&&U.a.createElement("li",{onClick:function(){e.onModalShow("see",r)},className:"tooltip-inner"},"详情"),te.a.hasPermission("cabinet-u-edit")&&U.a.createElement("li",{onClick:function(){e.onModalShow("up",r)},className:"tooltip-inner"},"编辑"),te.a.hasPermission("cabinet-u-delete")&&U.a.createElement("li",{onClick:function(){e.onDel(r.id)},className:"tooltip-inner"},"删除"),te.a.hasPermission("cabinet-u-edit")&&U.a.createElement("li",{onClick:function(){e.onLock(r)},className:"tooltip-inner"},0===r.lockStatus?"锁定":"解锁"),te.a.hasPermission("cabinet-u-edit")&&0!=r.status&&U.a.createElement("li",{onClick:function(){e.setStatus(0,"已购未分配",r)},className:"tooltip-inner"},"已购未分配"),te.a.hasPermission("cabinet-u-edit")&&1!=r.status&&U.a.createElement("li",{onClick:function(){e.setStatus(1,"已分配未使用",r)},className:"tooltip-inner"},"已分配未使用"),te.a.hasPermission("cabinet-u-edit")&&2!=r.status&&U.a.createElement("li",{onClick:function(){e.setStatus(2,"已启用未分配",r)},className:"tooltip-inner"},"已启用未分配"),te.a.hasPermission("cabinet-u-edit")&&3!=r.status&&U.a.createElement("li",{onClick:function(){e.setStatus(3,"已使用",r)},className:"tooltip-inner"},"已使用"),te.a.hasPermission("network-devices-view")&&U.a.createElement("li",{className:"tooltip-inner",onClick:function(){e.onShowChange(r)}},"交换机"),te.a.hasPermission("cabinet-u-view")&&U.a.createElement("li",{onClick:function(){e.onModalShowUBit(r)},className:"tooltip-inner"},"机柜U位管理")),title:r.name},U.a.createElement("div",{className:"box cabinet-status-".concat(r.status)},1===r.lockStatus&&U.a.createElement(Q,null),r.name))):(r={row:t,coulmn:a},U.a.createElement(We,{key:o,className:"td-box",record:{row:t,coulmn:a},moveRow:function(t){e.moveRow(t,r)}},U.a.createElement(i.a,{title:"行-列：".concat(o),trigger:"click",placement:"right",content:U.a.createElement("ul",{className:"opt-tooltip-box"},te.a.hasPermission("cabinet-u-add")&&U.a.createElement("li",{onClick:function(){e.onModalShow("add",r)},className:"tooltip-inner"},"添加"),te.a.hasPermission("cabinet-u-edit")&&U.a.createElement("li",{onClick:function(){e.setBarrier(r)},className:"tooltip-inner"},"设置障碍物"))},U.a.createElement("div",{className:"box"},U.a.createElement(X.a,null)))))})))}))))))),U.a.createElement(Ne,{visible:this.state.modalShow,modalLoading:this.state.modalLoading,data:this.state.nowDataCabinet,operateType:this.state.operateType,onOk:function(t){return e.onModalOk(t)},onClose:function(){return e.onModalClose()}}),U.a.createElement(M.a,{maskClosable:!1,title:"".concat(this.state.nowDataCabinet.name," 机柜U位管理"),destroyOnClose:!0,visible:this.state.modalShowUBit,width:"90%",footer:!1,onCancel:function(){return e.onModalCloseUBit()}},U.a.createElement(Ue.default,{cabinetId:this.state.nowCabinetId})),U.a.createElement(M.a,{visible:this.state.showChang,title:"交换机",width:"90%",onCancel:function(){return e.onCancel()},onOk:function(){return e.onCancel()},footer:null,okText:"确定",cancelText:"取消",destroyOnClose:!0},U.a.createElement(Me,{record:this.state.changeData})))}}]),n}(U.a.Component),R()(Le,"propTypes",{location:z.a.any,history:z.a.any}),_e=je))||_e},1599:function(e,t,a){"use strict";a(47);var n,o,r,i=a(17),c=a.n(i),l=a(15),s=a.n(l),u=a(19),d=a.n(u),m=a(6),f=a.n(m),p=a(20),h=a.n(p),g=a(21),y=a.n(g),b=a(13),v=a.n(b),S=a(2),w=a.n(S),k=(a(58),a(11)),E=a.n(k),C=a(0),O=a.n(C),N=a(1),D=a.n(N),R=a(23),P=a(5),I=a.n(P),x=a(9);function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var L=E.a.Option,j=Object(R.b)("root")(n=Object(R.b)("areaResouse")(n=Object(R.c)((r=o=function(e){h()(n,e);var t,a=(t=n,function(){var e,a=v()(t);if(_()){var n=v()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return y()(this,e)});function n(e){var t;return s()(this,n),t=a.call(this,e),w()(f()(t),"onSelect",(function(e,a){if(console.log(a),!e)return!1;t.selectNode={regionId:e,regionTitle:a.title,record:a.rowdata},t.props.onSearch(e,t.selectNode)})),w()(f()(t),"onUpdate",(function(){t.props.areaResouse.fetchRegion()})),t.selectNode={},t.state={selectNode:null,data:[]},t}return d()(n,[{key:"componentDidMount",value:function(){this.props.areaResouse.regionList.length<=0&&this.props.areaResouse.fetchRegion()}},{key:"render",value:function(){var e=this.props.areaResouse.regionList;return O.a.createElement(O.a.Fragment,null,O.a.createElement(E.a,{onChange:this.onSelect,placeholder:"请选择区域：地区-机房-区域",style:{width:300},onSearch:this.onSearch,allowClear:!0,showSearch:!0,filterOption:x.a.filterOption},I.a.map(e,(function(e){return O.a.createElement(L,{value:e.id,key:e.id,rowdata:e,title:e.locationCode}," ",e.locationCode," ")}))),O.a.createElement(c.a,{onClick:this.onUpdate},"更新区域"))}}]),n}(O.a.Component),w()(o,"propTypes",{areaResouse:D.a.any,onSearch:D.a.func,onClose:D.a.func,visible:D.a.bool,selectedIds:D.a.string}),n=r))||n)||n)||n;t.a=j},1601:function(e,t,a){"use strict";a(173);var n,o,r,i=a(84),c=a.n(i),l=(a(65),a(25)),s=a.n(l),u=(a(172),a(105)),d=a.n(u),m=(a(152),a(78)),f=a.n(m),p=a(15),h=a.n(p),g=a(19),y=a.n(g),b=a(6),v=a.n(b),S=a(20),w=a.n(S),k=a(21),E=a.n(k),C=a(13),O=a.n(C),N=a(2),D=a.n(N),R=a(0),P=a.n(R),I=a(1),x=a.n(I),_=(a(5),a(18)),L=a(1596),j=a(23),M=a(99),A=a(9),U=a(26);function T(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var z=Object(M.g)(n=Object(j.c)((r=o=function(e){w()(n,e);var t,a=(t=n,function(){var e,a=O()(t);if(T()){var n=O()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return E()(this,e)});function n(e){var t;return h()(this,n),t=a.call(this,e),D()(v()(t),"onClose",(function(){t.setState({modalShow:!1})})),t.selectAreaNode={},t.state={lists:[],loading:!1,modalShow:!1,page:1,pageSize:20,total:0},t}return y()(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){}},{key:"getLog",value:function(e){var t=this;this.setState({loading:!0}),_.a.get("".concat(BSS_ADMIN_URL,"/api/product/usagerecord"),{params:{uLocationId:this.props.uLocationId}}).then((function(e){e=e.data,A.a.hasStatusOk(e)?t.setState({loading:!1,lists:e.data.records}):(A.a.dealFail(e),t.setState({loading:!1}))})).catch((function(){t.setState({loading:!1})}))}},{key:"onPageChange",value:function(e,t){this.getLog(e,t)}},{key:"onPageSizeChange",value:function(e,t){this.getLog(e,t)}},{key:"onModalShow",value:function(){this.setState({modalShow:!0}),this.getLog()}},{key:"makeColumns",value:function(){return[{title:"管理ip",dataIndex:"managementIp",key:"managementIp"},{title:"设备",dataIndex:"deviceName",key:"deviceName"},{title:"设备类型",dataIndex:"type",key:"type",render:function(e,t){return U.f.uw_facility[e]}},{title:"出库时间",dataIndex:"outboundTime",key:"outboundTime",render:function(e,t){return A.a.getTime(e)}}]}},{key:"render",value:function(){var e=this,t=this.state,a=t.lists,n=t.modalShow,o=t.loading,r=t.page,i=t.total;return P.a.createElement(P.a.Fragment,null,P.a.createElement("main",{className:"mian"},P.a.createElement(s.a,{title:"出库记录",maskClosable:!1,width:"80%",destroyOnClose:!0,onCancel:this.onClose,footer:null,visible:n},P.a.createElement("div",{className:"g-table"},P.a.createElement(f.a,{columns:this.makeColumns(),rowKey:function(e){return e.id},loading:o,dataSource:a}),P.a.createElement(d.a,{size:"small",current:r,total:i,showSizeChanger:!0,onChange:function(t,a){e.onPageChange(t,a)},onShowSizeChange:function(t,a){e.onPageSizeChange(t,a)}})))),P.a.createElement("span",{className:"control-btn green",onClick:function(){return e.onModalShow()}},P.a.createElement(c.a,{placement:"top",title:"出库记录"},P.a.createElement(L.a,null))))}}]),n}(P.a.Component),D()(o,"propTypes",{location:x.a.any,history:x.a.any,match:x.a.any,root:x.a.any,powers:x.a.array,data:x.a.any,uLocationId:x.a.string}),n=r))||n)||n;t.a=z},1643:function(e,t,a){"use strict";a.d(t,"a",(function(){return K}));a(725);var n,o,r,i,c=a(423),l=a.n(c),s=(a(47),a(17)),u=a.n(s),d=(a(65),a(25)),m=a.n(d),f=a(15),p=a.n(f),h=a(19),g=a.n(h),y=a(6),b=a.n(y),v=a(20),S=a.n(v),w=a(21),k=a.n(w),E=a(13),C=a.n(E),O=a(2),N=a.n(O),D=(a(416),a(192)),R=a.n(D),P=(a(58),a(11)),I=a.n(P),x=(a(98),a(55)),_=a.n(x),L=(a(60),a(12)),j=a.n(L),M=a(0),A=a.n(M),U=a(1),T=a.n(U),z=(a(5),a(18),a(1919)),B=a(23),F=a(99),V=(a(3),a(28),a(9)),G=(a(153),a(1601),a(1599),a(52));a(16);function q(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}j.a.Item,_.a.TextArea,I.a.Option,R.a.TreeNode;var K=(n=Object(B.b)("root"),Object(F.g)(o=n((i=r=function(e){S()(n,e);var t,a=(t=n,function(){var e,a=C()(t);if(q()){var n=C()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return k()(this,e)});function n(e){var t;return p()(this,n),t=a.call(this,e),N()(b()(t),"formRefAdd",A.a.createRef()),N()(b()(t),"onClose",(function(){t.setState({showModal:!1})})),t.selectAreaNode={},t.selectedRows=[],t.houseId="",t.uw=0,t.state={fileList:[],uploading:!1},t}return g()(n,[{key:"componentDidMount",value:function(){}},{key:"modalShow",value:function(){this.setState({showModal:!0})}},{key:"render",value:function(){var e=this,t=this.state,a=(t.uploading,t.fileList,t.showModal),n={name:"file",method:"post",action:this.props.url,headers:{Authorization:"token "+G.a.getToken()},onChange:function(e){"uploading"!==e.file.status&&console.log("已上传"),"done"===e.file.status?2e4==e.file.response.code?(V.a.auto_close_result("ok","上传成功！"),this.setState({showModal:!1})):V.a.dealFail(e.file.response):"error"===e.file.status&&m.a.error({title:"上传失败！"})}};return A.a.createElement(A.a.Fragment,null,A.a.createElement(m.a,{title:this.props.title||"上传文件",maskClosable:!1,width:"600px",destroyOnClose:!0,footer:!1,onCancel:this.onClose,visible:a},A.a.createElement(l.a,n,A.a.createElement(u.a,null," ",A.a.createElement(z.a,null)," ",this.props.filetext," "))),A.a.createElement("span",{onClick:function(){e.modalShow()}},this.props.children))}}]),n}(A.a.Component),N()(r,"propTypes",{location:T.a.any,history:T.a.any,match:T.a.any,root:T.a.any,children:T.a.any,houseId:T.a.string,title:T.a.string,powers:T.a.array,onSelect:T.a.func,filetext:T.a.any,url:T.a.string}),o=i))||o)||o)},1730:function(e,t,a){},1735:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var r=n?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(a,o,r):a[o]=e[o]}a.default=e,t&&t.set(e,a);return a}(a(0)),r=(n=a(84))&&n.__esModule?n:{default:n},i=a(29),c=a(731);function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(a[n[o]]=e[n[o]])}return a},b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(b,e);var t,a,n,l,s=(t=b,function(){var e,a=g(t);if(h()){var n=g(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return p(this,e)});function b(){var e;return d(this,b),(e=s.apply(this,arguments)).saveTooltip=function(t){e.tooltip=t},e.renderPopover=function(t){var a=t.getPrefixCls,n=e.props,i=n.prefixCls,c=y(n,["prefixCls"]);delete c.title;var l=a("popover",i);return o.createElement(r.default,u({},c,{prefixCls:l,ref:e.saveTooltip,overlay:e.getOverlay(l)}))},e}return a=b,(n=[{key:"getPopupDomNode",value:function(){return this.tooltip.getPopupDomNode()}},{key:"getOverlay",value:function(e){var t=this.props,a=t.title,n=t.content;return o.createElement(o.Fragment,null,a&&o.createElement("div",{className:"".concat(e,"-title")},(0,c.getRenderPropValue)(a)),o.createElement("div",{className:"".concat(e,"-inner-content")},(0,c.getRenderPropValue)(n)))}},{key:"render",value:function(){return o.createElement(i.ConfigConsumer,null,this.renderPopover)}}])&&m(a.prototype,n),l&&m(a,l),b}(o.Component);t.default=b,b.defaultProps={placement:"top",transitionName:"zoom-big",trigger:"hover",mouseEnterDelay:.1,mouseLeaveDelay:.1,overlayStyle:{}}},1919:function(e,t,a){"use strict";var n=a(0),o={name:"upload",theme:"outlined",icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]}},r=a(69),i=function(e,t){return n.createElement(r.a,Object.assign({},e,{ref:t,icon:o}))};i.displayName="UploadOutlined";t.a=n.forwardRef(i)}}]);