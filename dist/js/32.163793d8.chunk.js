(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{1565:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Ie}));a(152);var n,o,r,c=a(78),s=a.n(c),l=(a(47),a(17)),i=a.n(l),u=(a(1634),a(1638)),d=a.n(u),f=(a(254),a(116)),m=a.n(f),h=(a(255),a(133)),p=a.n(h),y=(a(173),a(84)),g=a.n(y),v=(a(175),a(66)),E=a.n(v),k=(a(132),a(35)),C=a.n(k),N=a(15),S=a.n(N),b=a(19),w=a.n(b),R=a(6),D=a.n(R),I=a(20),L=a.n(I),x=a(21),O=a.n(x),F=a(13),M=a.n(F),K=a(2),T=a.n(K),G=(a(1902),a(1905)),A=a.n(G),P=(a(65),a(25)),U=a.n(P),q=(a(60),a(12)),j=a.n(q),B=(a(58),a(11)),Q=a.n(B),z=a(0),V=a.n(z),W=a(1),J=a.n(W),H=a(1592),X=a(1589),Y=a(1716),Z=a(23),$=(a(1904),a(9)),ee=(a(71),a(5),a(18)),te=(a(98),a(55)),ae=a.n(te),ne=a(33),oe=a.n(ne),re=(a(416),a(192)),ce=a.n(re),se=a(28),le=a(26);function ie(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ue,de,fe,me=j.a.Item,he=ce.a.TreeNode,pe=Q.a.Option,ye=(ce.a.SHOW_PARENT,Object(Z.b)("root")(n=Object(Z.c)((r=o=function(e){L()(n,e);var t,a=(t=n,function(){var e,a=M()(t);if(ie()){var n=M()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return O()(this,e)});function n(e){var t;return S()(this,n),t=a.call(this,e),T()(D()(t),"onClose",(function(){t.props.onClose()})),T()(D()(t),"onFinish",(function(e){t.props.onOK(e)})),T()(D()(t),"reset",(function(){t.formRef.current.resetFields()})),T()(D()(t),"onChange",(function(e){console.log(e)})),T()(D()(t),"getNodes",(function(e){return e.reduce((function(e,a){return e.push(V.a.createElement(he,{value:a.id,title:a.name,key:a.id,level:a.level},a.children?t.getNodes(a.children):null)),e}),[])})),t.formRef=V.a.createRef(),t.state={modalLoading:!1,nowData:null,fetching:!0,loading:!1},t}return w()(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){}},{key:"render",value:function(){var e=this,t=this.props,a=t.lists,n={parId:t.selectedKeys[0]};return V.a.createElement("div",null,V.a.createElement(j.a,{name:"form_in_modal",ref:this.formRef,initialValues:n,onFinish:function(t){e.onFinish(t)},className:"g-modal-field"},V.a.createElement(me,oe()({label:"请选择上级类目",name:"parId",rules:[{required:!0,message:"必填"}]},se.b),V.a.createElement(ce.a,{placeholder:"请选择",allowClear:!0,onChange:this.onChange},this.getNodes(a))),V.a.createElement(me,oe()({label:"前台展示名",name:"showName",rules:[{required:!0,message:"必填"}]},se.b),V.a.createElement(ae.a,{placeholder:"请输入展示名"})),V.a.createElement(me,oe()({label:"类目名",name:"name",rules:[{required:!0,message:"必填"}]},se.b),V.a.createElement(ae.a,{placeholder:"请输入类目名"})),V.a.createElement(me,oe()({label:"管理的产品类别",name:"type"},se.b),V.a.createElement(Q.a,{placeholder:"请选择",allowClear:!0},_.map(le.i.product_category_type,(function(e,t){return V.a.createElement(pe,{value:parseInt(t),key:t},e)})))),V.a.createElement(me,oe()({label:"最小资源配置",name:"resourceConfigs"},se.b),V.a.createElement(Q.a,{placeholder:"请选择",allowClear:!0,mode:"multiple"},_.map(le.i.product_resource_config,(function(e,t){return V.a.createElement(pe,{value:parseInt(t),key:t},e)})))),V.a.createElement("div",{className:"actions-btn"},V.a.createElement(i.a,{htmlType:"submit",className:"action-btn ok"},"提交"),V.a.createElement(i.a,{htmlType:"reset",className:"action-btn ok",onClick:this.reset},"重置"),V.a.createElement(i.a,{onClick:this.onClose,className:"action-btn ok",style:{margin:"0 auto"}},"取消"))))}}]),n}(V.a.Component),T()(o,"propTypes",{location:J.a.any,history:J.a.any,userinfo:J.a.any,powers:J.a.array,updateLists:J.a.func}),n=r))||n)||n),ge=(a(171),a(89)),ve=a.n(ge),Ee=(a(193),a(75)),ke=a.n(Ee);function Ce(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ne,Se,be,we=j.a.Item,Re=Object(Z.b)("authManage")(ue=Object(Z.c)((fe=de=function(e){L()(n,e);var t,a=(t=n,function(){var e,a=M()(t);if(Ce()){var n=M()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return O()(this,e)});function n(e){var t;return S()(this,n),t=a.call(this,e),T()(D()(t),"onClose",(function(){t.setState({showModal:!1})})),T()(D()(t),"onFinish",(function(e){e.version=t.props.record.version,ee.a.put("".concat(BSS_ADMIN_URL,"/api/goods/category/").concat(t.props.record.id,"/update"),$.a.clearNull(e)).then((function(e){2e4===(e=e.data).code?(t.onClose(),t.props.updatalists(),C.a.success("修改成功")):$.a.dealFail(e)})).catch((function(){}))})),T()(D()(t),"reset",(function(){t.formRef.current.resetFields()})),t.formRef=V.a.createRef(),t.state={loading:!1,showModal:!1},t}return w()(n,[{key:"componentDidMount",value:function(){}},{key:"modalShow",value:function(){this.setState({showModal:!0})}},{key:"render",value:function(){var e=this,t=this.props.record;return V.a.createElement("main",{style:{display:"inline-block"}},V.a.createElement(U.a,{title:"修改前台展示名",visible:this.state.showModal,destroyOnClose:!0,width:"50%",onCancel:this.onClose,footer:null},V.a.createElement(ve.a,null,V.a.createElement(ke.a,{xs:24,sm:24,md:24,lg:24,xl:24},V.a.createElement(j.a,{name:"form_in_modal",ref:this.formRef,initialValues:t,onFinish:function(t){e.onFinish(t)},className:"g-modal-field"},V.a.createElement(we,oe()({label:"前台展示名",name:"showName",rules:[{required:!0,message:"必填"}]},se.b),V.a.createElement(ae.a,{placeholder:"请输入展示名"})),V.a.createElement("div",{className:"actions-btn"},V.a.createElement(i.a,{htmlType:"submit",className:"action-btn ok"},"提交"),V.a.createElement(i.a,{htmlType:"reset",className:"action-btn ok",onClick:this.reset},"重置"),V.a.createElement(i.a,{onClick:this.onClose,className:"action-btn ok",style:{margin:"0 auto"}},"取消")))))),V.a.createElement("span",{onClick:function(){e.modalShow()}},this.props.children))}}]),n}(V.a.PureComponent),T()(de,"propTypes",{data:J.a.array,title:J.a.string,visible:J.a.bool,defaultKeys:J.a.array,loading:J.a.bool,onOk:J.a.func,onClose:J.a.func,record:J.a.object}),ue=fe))||ue)||ue;function De(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}Q.a.Option,j.a.Item,U.a.confirm;var _e=A.a.TreeNode;var Ie=Object(Z.c)((be=Se=function(e){L()(n,e);var t,a=(t=n,function(){var e,a=M()(t);if(De()){var n=M()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return O()(this,e)});function n(e){var t;return S()(this,n),t=a.call(this,e),T()(D()(t),"updateURL",(function(){var e,a,n,o,r=(e={query:t.state.inputValue},a=e.query,n=void 0===a?"":a,(o=new URLSearchParams).set("query",n),o.toString());t.props.history.push("?".concat(r))})),T()(D()(t),"onSelect",(function(e,a){t.selectedKeys=e,0!==e.length&&t.onGetListData2(t.selectedKeys)})),T()(D()(t),"onAddShow",(function(){t.setState({addShow:!0})})),T()(D()(t),"onCancel",(function(){t.setState({addShow:!1})})),T()(D()(t),"getNodes",(function(e){return e.reduce((function(e,a){return e.push(V.a.createElement(_e,{value:a.id,title:a.name,key:a.id,level:a.level},a.children?t.getNodes(a.children):null)),e}),[])})),T()(D()(t),"handleOk",(function(e){ee.a.post("".concat(BSS_ADMIN_URL,"/api/goods/category/add"),$.a.clearEmpty(e)).then((function(e){2e4===(e=e.data).code?(t.onCancel(),t.onGetListData(),C.a.success("添加成功")):$.a.dealFail(e)})).catch((function(){}))})),T()(D()(t),"updatalists",(function(e){t.onGetListData2(e)})),T()(D()(t),"onDel",(function(e){ee.a.delete("".concat(BSS_ADMIN_URL,"/api/goods/category/").concat(e,"/delete")).then((function(e){2e4===(e=e.data).code?(t.onGetListData(),t.onGetListData2("0012095310f347109eacc980cd1ce500"),C.a.success("删除成功")):$.a.dealFail(e)})).catch((function(){}))})),T()(D()(t),"changeStatus",(function(e,a){a.status;var n={status:0===e?1:0,version:a.version};console.log(t.selectedKeys),t.setState({loading:!0}),ee.a.post("".concat(BSS_ADMIN_URL,"/api/goods/category/").concat(a.id,"/start-using"),$.a.clearNull(n)).then((function(e){2e4===(e=e.data).code?(t.onGetListData2(t.selectedKeys),C.a.success("修改状态成功")):$.a.dealFail(e)})).catch((function(){}))})),t.searchFormRef=V.a.createRef(),t.searchCondition={},t.state={lists:[],loading:!1,pageNum:1,page_size:20,total:0,addShow:!1,lists2:[]},t}return w()(n,[{key:"componentDidMount",value:function(){this.onGetListData(),this.onGetListData2("0012095310f347109eacc980cd1ce500")}},{key:"componentWillReceiveProps",value:function(){}},{key:"onGetListData",value:function(){var e=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setState({loading:!0}),ee.a.get("".concat(BSS_ADMIN_URL,"/api/goods/category")).then((function(t){if(t=t.data,$.a.hasStatusOk(t)){var a,n=t.data;a=$.a.formatTree(n),e.setState({lists:a})}else $.a.dealFail(t);e.setState({loading:!1})})).catch((function(){e.setState({loading:!1})}))}},{key:"onGetListData2",value:function(e){var t=this;this.setState({loading:!0}),ee.a.get("".concat(BSS_ADMIN_URL,"/api/goods/category/").concat(e,"/get")).then((function(e){if(e=e.data,$.a.hasStatusOk(e)){var a=e.data;t.level=a[0].level,t.productQuantity=a[0].productQuantity,t.lowerCategoryNum=a[0].lowerCategoryNum,t.status=a[0].status,t.resourceConfigs=a[0].resourceConfigs,t.setState({lists2:a})}else $.a.dealFail(e);t.setState({loading:!1})})).catch((function(){t.setState({loading:!1})}))}},{key:"makeColumns",value:function(){var e=this,t=[{title:"类目名",dataIndex:"name",key:"name"},{title:"前台展示名",dataIndex:"showName",key:"showName",render:function(e,t){return V.a.createElement(E.a,{color:"#2db7f5"},t&&t.showName)}},{title:"操作",key:"control",render:function(t,a){var n=[];n.push(V.a.createElement(Re,{record:a,updatalists:function(){return e.updatalists(e.selectedKeys)}},V.a.createElement("span",{key:"1",className:"control-btn blue"},V.a.createElement(g.a,{placement:"top",title:"修改"},V.a.createElement(H.a,{style:{color:"#1890ff"}}))))),e.level>=3&&0===e.productQuantity&&n.push(V.a.createElement(p.a,{key:"4",title:"确定删除吗?",onConfirm:function(){return e.onDel(a.id)},okText:"确定",cancelText:"取消"},V.a.createElement("span",{className:"control-btn red"},V.a.createElement(g.a,{placement:"top",title:"删除"},V.a.createElement(X.a,{style:{color:"red"}})))));var o=[];return n.forEach((function(e,t){t&&o.push(V.a.createElement(m.a,{key:"line".concat(t),type:"vertical"})),o.push(e)})),o}}];return this.resourceConfigs&&this.resourceConfigs.length>0&&t.unshift({title:"最小资源配置",dataIndex:"resourceConfigs",key:"resourceConfigs",render:function(e,t){return e&&e.map((function(e){return V.a.createElement("span",{key:e.id},e.configName)}))}}),0!==this.status&&1!==this.status||t.push({title:"状态",dataIndex:"status",key:"status",render:function(t,a){return 1===t?V.a.createElement(d.a,{defaultChecked:!0,size:"small",onChange:function(){return e.changeStatus(t,a)}}):V.a.createElement(d.a,{size:"small",onChange:function(){return e.changeStatus(t,a)}})}}),this.lowerCategoryNum>0&&t.unshift({title:"下级类目数",dataIndex:"lowerCategoryNum",key:"lowerCategoryNum",render:function(e,t){return V.a.createElement(E.a,{color:"#87d068"},t&&t.lowerCategoryNum)}}),2===this.level&&t.unshift({title:"上级类目名",dataIndex:"superiorName",key:"superiorName"}),this.level>=3&&(t.unshift({title:"产品数",dataIndex:"productQuantity",key:"productQuantity",render:function(e,t){return V.a.createElement(E.a,{color:"#87d068"},t&&t.productQuantity)}}),t.unshift({title:"管理的产品类型",dataIndex:"type",key:"type",render:function(e,t){return le.i.product_category_type[e]}}),t.unshift({title:"上级类目名",dataIndex:"superiorName",key:"superiorName"})),t}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.lists,o=t.lists2;return V.a.createElement("main",{className:"mian"},V.a.createElement("div",{className:"left-contain",style:{marginRight:"0px",padding:"20px"}},V.a.createElement(A.a,{showLine:!0,switcherIcon:V.a.createElement(Y.a,null),blockNode:!0,defaultSelectedKeys:["0012095310f347109eacc980cd1ce500"],onSelect:this.onSelect,loading:a},this.getNodes(n))),V.a.createElement("div",{className:"right-contain"},V.a.createElement("div",{className:"c-operate"},(this.level>=2||this.resourceConfigs&&0===this.resourceConfigs.length)&&V.a.createElement(i.a,{size:"middle",onClick:this.onAddShow,style:{color:"#1890ff",borderColor:"#1890ff"}},"新增类目")),V.a.createElement("div",{className:"g-table"},V.a.createElement(s.a,{columns:this.makeColumns(),rowKey:function(e){return e.id},loading:a,dataSource:o,pagination:!1}))),V.a.createElement(U.a,{title:"新增类目",visible:this.state.addShow,onCancel:this.onCancel,footer:null,destroyOnClose:!0,width:"50%"},V.a.createElement(ye,{onClose:this.onCancel,lists:n,selectedKeys:this.selectedKeys,onOK:function(t){return e.handleOk(t)}})))}}]),n}(V.a.Component),T()(Se,"propTypes",{location:J.a.any,history:J.a.any,userinfo:J.a.any,powers:J.a.array,authManage:J.a.any,match:J.a.any,pageUserstore:J.a.any,root:J.a.any,serverPartDict:J.a.any,serverDict:J.a.any}),Ne=be))||Ne},1904:function(e,t,a){}}]);