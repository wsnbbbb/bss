(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{1579:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Ee}));a(152);var n,o,r,i=a(78),c=a.n(i),s=(a(47),a(17)),l=a.n(s),u=(a(60),a(12)),d=a.n(u),p=(a(98),a(55)),m=a.n(p),f=(a(254),a(116)),h=a.n(f),y=(a(255),a(133)),g=a.n(y),v=(a(173),a(84)),b=a.n(v),S=(a(65),a(25)),k=a.n(S),O=a(15),w=a.n(O),E=a(19),R=a.n(E),D=a(6),C=a.n(D),L=a(20),j=a.n(L),I=a(21),N=a.n(I),x=a(13),T=a.n(x),P=(a(58),a(11)),M=a.n(P),F=a(33),A=a.n(F),B=a(2),z=a.n(B),G=a(185),U=a.n(G),V=a(311),q=a.n(V),J=a(0),H=a.n(J),K=a(1),Q=a.n(K),W=a(1591),X=a(1596),Y=a(1592),Z=a(1590),$=a(1589),ee=a(23),te=a(18),ae=a(9),ne=(a(174),a(107)),oe=a.n(ne),re=(a(5),a(28)),ie=a(1621);function ce(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(a),!0).forEach((function(t){z()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ce(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function le(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ue,de,pe,me=d.a.Item,fe=m.a.TextArea,he=Object(ee.b)("root")(n=Object(ee.c)((r=o=function(e){j()(n,e);var t,a=(t=n,function(){var e,a=T()(t);if(le()){var n=T()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return N()(this,e)});function n(e){var t;return w()(this,n),t=a.call(this,e),z()(C()(t),"onResetSearch",(function(){t.formRef.current.resetFields()})),z()(C()(t),"onClose",(function(){t.parId=-1,t.props.onClose()})),z()(C()(t),"onSelectRegion",(function(e){t.parId=e})),t.formRef=H.a.createRef(),t.parId=void 0,t.state={modalLoading:!1,modalShowRegion:!1},t}return R()(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){"add"==e.operateType?this.parId=0:this.parId=e.data.parId}},{key:"onFinish",value:function(e){var t=this.props.operateType,a=se({},e,{parId:this.parId||0});"see"!==t?("up"===t&&(a=se({},a,{version:this.props.data.version})),this.props.onOk(a)):this.props.onClose()}},{key:"render",value:function(){var e=this,t=this.props,a=t.operateType,n=t.data,o=t.modalLoading,r=t.visible;return H.a.createElement("div",null,H.a.createElement(k.a,{title:{add:"新增",addchild:"添加下级地区",up:"修改",see:"查看"}[a],maskClosable:!1,width:"60%",destroyOnClose:!0,footer:null,onCancel:this.props.onClose,visible:r},H.a.createElement(oe.a,{tip:"Loading...",spinning:o},H.a.createElement(d.a,{name:"form_in_modal",ref:this.formRef,className:"g-modal-field",onFinish:function(t){e.onFinish(t)},initialValues:n},H.a.createElement(me,A()({label:"上级地区"},re.b),H.a.createElement(ie.a,{disabled:"see"===a,districtId:n.parId,placeholder:"请选择上级地区",onSelect:function(t){e.onSelectRegion(t)}})),H.a.createElement(me,A()({label:"地区名称",name:"name",rules:[{required:!0,message:"请输入地区名称"},{max:15,message:"最多输入15个字符"}]},re.b),H.a.createElement(m.a,{type:"text",placeholder:"请输入",disabled:"see"==a||"up"==a})),H.a.createElement(me,A()({label:"地区编码",name:"code",rules:[{required:!0,message:"请输入地区编码"},{max:10,message:"最多输入10个字符"}]},re.b),H.a.createElement(m.a,{placeholder:"例如：重庆编码为CQ",disabled:"see"==a||"up"==a})),H.a.createElement(me,A()({label:"备注",name:"remark",rules:[{max:250,message:"最多输入250个字符"}]},re.b),H.a.createElement(fe,{placeholder:"请输入备注",disabled:"see"===a})),"see"!==a&&H.a.createElement("div",{className:"actions-btn"},H.a.createElement(l.a,{htmlType:"submit",className:"action-btn ok"},"确认提交"),H.a.createElement(l.a,{onClick:this.onClose,className:"action-btn ok"},"取消"))))))}}]),n}(H.a.Component),z()(o,"propTypes",{location:Q.a.any,history:Q.a.any,root:Q.a.any,operateType:Q.a.string,powers:Q.a.array,data:Q.a.any,visible:Q.a.bool,modalLoading:Q.a.bool,onOk:Q.a.func,onClose:Q.a.func}),n=r))||n)||n,ye=a(1924),ge=a(1923),ve=a(52);function be(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Se(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ke(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(a),!0).forEach((function(t){z()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Se(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Oe="DragbleBodyRow",we=function(e){var t=e.index,a=e.moveRow,n=e.className,o=e.style,r=e.record,i=q()(e,["index","moveRow","className","style","record"]),c=H.a.useRef(),s=Object(ye.a)({accept:Oe,collect:function(e){var a=(e.getItem()||{}).index;return a===t?{}:{begainItem:e.getItem(),isOver:e.isOver(),dropClassName:a<t?" drop-over-downward":" drop-over-upward"}},drop:function(e){a(e.index,t,e)}}),l=U()(s,2),u=l[0],d=u.isOver,p=u.dropClassName,m=l[1],f=Object(ge.a)({item:{type:Oe,index:t,record:r},collect:function(e){return{isDragging:e.isDragging()}},beginDrag:function(e,t,a){return{record:e.record}}});return m((0,U()(f,2)[1])(c)),H.a.createElement("tr",A()({ref:c,className:"".concat(n).concat(d?p:""),style:ke({cursor:"move"},o)},i))},Ee=(M.a.Option,Object(ee.b)("roomManage")(ue=Object(ee.b)("areaResouse")(ue=Object(ee.c)((pe=de=function(e){j()(n,e);var t,a=(t=n,function(){var e,a=T()(t);if(be()){var n=T()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return N()(this,e)});function n(e){var t;return w()(this,n),t=a.call(this,e),z()(C()(t),"searchFormRef",H.a.createRef()),z()(C()(t),"onResetSearch",(function(){t.searchFormRef.current.resetFields()})),z()(C()(t),"components",{body:{row:we}}),z()(C()(t),"moveRow",(function(e,a,n,o,r){if(e==a)return!1;var i=t.state.originList,c=n.record.parId,s=[];_.map(i,(function(e){e.parId==c&&s.push(e)}));var l=[];if(e>a){var u=s.slice(a,e);u.forEach((function(e){l.push({id:e.id,sort:e.sort+1})})),l.unshift({id:n.record.id,sort:n.record.sort-u.length})}if(a>e){var d=s.slice(e+1,a+1);d.forEach((function(e){l.push({id:e.id,sort:e.sort-1})})),l.push({id:n.record.id,sort:n.record.sort+d.length})}te.a.post("".concat(BSS_ADMIN_URL,"/api/product/area/sort"),l).then((function(e){e=e.data,ae.a.hasStatusOk(e)?(t.setState({modalLoading:!1,modalShow:!1}),t.onGetListData()):ae.a.dealFail(e),t.setState({modalLoading:!1})})).catch((function(){t.setState({modalLoading:!1})}))})),t.searchCondition={},t.state={lists:[],originList:[],originTreeList:[],loading:!1,page:1,pageSize:20,total:0,operateType:"add",modalShow:!1,modalLoading:!1,nowData:{}},t}return R()(n,[{key:"componentDidMount",value:function(){this.props.areaResouse.areaTreeList.length<=0&&this.props.areaResouse.fetchArea(),this.onGetListData()}},{key:"onGetListData",value:function(e){var t=this,a=_.assign({},e,this.searchCondition);this.setState({loading:!0}),te.a.get("".concat(BSS_ADMIN_URL,"/api/product/area"),{params:ae.a.clearNull(a)}).then((function(e){if(e=e.data,ae.a.hasStatusOk(e))if(t.searchCondition&&t.searchCondition.name)t.setState({lists:e.data});else{var a=ae.a.makeSourceData(e.data);t.setState({lists:a,originList:e.data,originTreeList:a})}else ae.a.dealFail(e);t.setState({loading:!1})})).catch((function(){t.setState({loading:!1})}))}},{key:"onSearch",value:function(e){this.searchCondition=e,this.onGetListData(e)}},{key:"onModalShow",value:function(e,t){var a={parId:"0",code:"",name:"",remark:""};"up"!=e&&"see"!=e||(a=t),"addchild"==e&&(a=ke({},a,{parId:t.id})),this.setState({modalShow:!0,nowData:a,operateType:e})}},{key:"onModalOk",value:function(e){var t=this;if(this.setState({modalLoading:!0}),"add"==this.state.operateType||"addchild"==this.state.operateType){var a=ae.a.clearNull(e);this.props.areaResouse.fetchArea(),te.a.post("".concat(BSS_ADMIN_URL,"/api/product/area/add"),a).then((function(e){e=e.data,ae.a.hasStatusOk(e)?(t.setState({modalLoading:!1,modalShow:!1}),ae.a.auto_close_result("ok","操作成功"),t.onGetListData(),t.props.areaResouse.fetchArea()):ae.a.dealFail(e),t.setState({modalLoading:!1})})).catch((function(){t.setState({modalLoading:!1})}))}else te.a.put("".concat(BSS_ADMIN_URL,"/api/product/area/").concat(this.state.nowData.id,"/update"),ae.a.clearNull(e)).then((function(e){e=e.data,ae.a.hasStatusOk(e)?(t.setState({modalLoading:!1,modalShow:!1}),t.onGetListData(),t.props.areaResouse.fetchArea(),ae.a.auto_close_result("ok","操作成功")):ae.a.dealFail(e),t.setState({modalLoading:!1})})).catch((function(){t.setState({modalLoading:!1})}))}},{key:"onModalClose",value:function(){this.setState({modalShow:!1})}},{key:"onDel",value:function(e){var t=this;k.a.confirm({icon:H.a.createElement(W.a,null),content:"确认执行删除操作吗？",onOk:function(){t.setState({loading:!0}),te.a.delete("".concat(BSS_ADMIN_URL,"/api/product/area/").concat(e,"/delete")).then((function(e){e=e.data,ae.a.hasStatusOk(e)?(ae.a.auto_close_result("ok","操作成功"),t.onGetListData(),t.props.areaResouse.fetchArea()):(ae.a.dealFail(e),t.setState({loading:!1}))})).catch((function(){t.setState({loading:!1})}))},onCancel:function(){console.log("Cancel")}})}},{key:"makeColumns",value:function(){var e=this;return[{title:"区域名称",dataIndex:"name",key:"name"},{title:"区域编码",dataIndex:"code",key:"code"},{title:"备注",dataIndex:"remark",key:"remark"},{title:"操作",key:"control",fixed:"right",width:180,render:function(t,a){var n=[];ve.a.hasPermission("area-view")&&n.push(H.a.createElement("span",{key:"0",className:"control-btn green",onClick:function(){return e.onModalShow("see",a)}},H.a.createElement(b.a,{placement:"top",title:"查看"},H.a.createElement(X.a,null)))),ve.a.hasPermission("area-edit")&&n.push(H.a.createElement("span",{key:"1",className:"control-btn blue",onClick:function(){return e.onModalShow("up",a)}},H.a.createElement(b.a,{placement:"top",title:"修改"},H.a.createElement(Y.a,null)))),ve.a.hasPermission("area-add")&&n.push(H.a.createElement("span",{key:"2",className:"control-btn blue",onClick:function(){return e.onModalShow("addchild",a)}},H.a.createElement(b.a,{placement:"top",title:"添加下级区域"},H.a.createElement(Z.a,null)))),ve.a.hasPermission("area-del")&&n.push(H.a.createElement(g.a,{key:"3",title:"确定删除吗?",onConfirm:function(){return e.onDel(a.id)},okText:"确定",cancelText:"取消"},H.a.createElement("span",{className:"control-btn red"},H.a.createElement(b.a,{placement:"top",title:"删除"},H.a.createElement($.a,null)))));var o=[];return n.forEach((function(e,t){t&&o.push(H.a.createElement(h.a,{key:"line".concat(t),type:"vertical"})),o.push(e)})),o}}]}},{key:"render",value:function(){var e=this,t=this.state,a=t.lists,n=t.loading;return H.a.createElement("main",{className:"mian"},H.a.createElement("div",{className:"g-search"},H.a.createElement(d.a,{ref:this.searchFormRef,name:"searchbox",layout:"inline",onFinish:function(t){e.onSearch(t)}},H.a.createElement(d.a.Item,{name:"name"},H.a.createElement(m.a,{placeholder:"区域名称",allowClear:!0})),H.a.createElement(d.a.Item,null,H.a.createElement(l.a,{type:"primary",htmlType:"submit"},"搜索")),H.a.createElement(d.a.Item,null,H.a.createElement(l.a,{type:"primary",onClick:this.onResetSearch},"重置")))),H.a.createElement("div",{className:"g-operate"},ve.a.hasPermission("area-add")&&H.a.createElement(l.a,{size:"middle",className:"actions-btn",onClick:function(){e.onModalShow("add")}},"添加地区")),H.a.createElement("div",{className:"g-table"},H.a.createElement(c.a,{columns:this.makeColumns(),rowKey:function(e){return e.id},loading:n,dataSource:a,pagination:!1,components:ve.a.hasPermission("area-option")?this.components:{},onRow:function(t,a){return{record:t,index:a,moveRow:function(n,o,r){e.moveRow(n,o,r,t,a)}}},expandable:{indentSize:0,expandRowByClick:!0}})),H.a.createElement(he,{visible:this.state.modalShow,modalLoading:this.state.modalLoading,data:this.state.nowData,operateType:this.state.operateType,onOk:function(t){return e.onModalOk(t)},onClose:function(){return e.onModalClose()}}))}}]),n}(H.a.Component),z()(de,"propTypes",{location:Q.a.any,history:Q.a.any,userinfo:Q.a.any,powers:Q.a.array}),ue=pe))||ue)||ue)||ue)},1596:function(e,t,a){"use strict";var n=a(0),o={name:"eye",theme:"outlined",icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]}},r=a(69),i=function(e,t){return n.createElement(r.a,Object.assign({},e,{ref:t,icon:o}))};i.displayName="EyeOutlined";t.a=n.forwardRef(i)},1621:function(e,t,a){"use strict";var n,o,r,i=a(15),c=a.n(i),s=a(19),l=a.n(s),u=a(6),d=a.n(u),p=a(20),m=a.n(p),f=a(21),h=a.n(f),y=a(13),g=a.n(y),v=a(2),b=a.n(v),S=(a(416),a(192)),k=a.n(S),O=(a(65),a(25)),w=a.n(O),E=(a(58),a(11)),R=a.n(E),D=(a(98),a(55)),C=a.n(D),L=(a(60),a(12)),j=a.n(L),I=a(0),N=a.n(I),x=a(1),T=a.n(x),P=a(23),M=a(5),_=a.n(M);a(18),a(9),a(28);function F(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}j.a.Item,C.a.TextArea,R.a.Option,w.a.confirm;var A=k.a.TreeNode,B=Object(P.b)("root")(n=Object(P.b)("areaResouse")(n=Object(P.c)((r=o=function(e){m()(n,e);var t,a=(t=n,function(){var e,a=g()(t);if(F()){var n=g()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return h()(this,e)});function n(e){var t;return c()(this,n),t=a.call(this,e),b()(d()(t),"onSelect",(function(e){t.props.onSelect(e),t.setState({value:e})})),t.state={value:t.props.defaultValue,treedata:t.props.areaResouse.areaTreeList},t}return l()(n,[{key:"componentDidMount",value:function(){}},{key:"makeDomTree",value:function(e){var t=this;return e.children&&e.children.length>0?N.a.createElement(A,{title:e.name,key:e.id,value:e.id,disabled:"0"===e.id&&"house"===this.props.type},_.a.map(e.children,(function(e){return t.makeDomTree(e)}))):N.a.createElement(A,{title:e.name,key:e.id,value:e.id}," ")}},{key:"render",value:function(){var e=this,t=this.state.treedata;return N.a.createElement(N.a.Fragment,null,N.a.createElement(k.a,{disabled:this.props.disabled,defaultValue:this.props.districtId,placeholder:this.props.placeholder,style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treedefaultexpandallshow:"false",allowClear:!0,onChange:this.onSelect},_.a.map(t,(function(t){return e.makeDomTree(t)}))))}}]),n}(N.a.Component),b()(o,"propTypes",{areaResouse:T.a.any,disabled:T.a.bool,defaultValue:T.a.string,placeholder:T.a.string,onSelect:T.a.func}),n=r))||n)||n)||n;t.a=B}}]);