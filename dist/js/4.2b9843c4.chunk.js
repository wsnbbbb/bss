(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1599:function(e,t,n){"use strict";n(47);var a,o,r,i=n(17),s=n.n(i),c=n(15),l=n.n(c),u=n(19),d=n.n(u),f=n(6),h=n.n(f),p=n(20),m=n.n(p),y=n(21),g=n.n(y),v=n(13),w=n.n(v),S=n(2),b=n.n(S),I=(n(58),n(11)),k=n.n(I),R=n(0),C=n.n(R),O=n(1),E=n.n(O),N=n(23),D=n(5),x=n.n(D),L=n(9);function j(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var P=k.a.Option,M=Object(N.b)("root")(a=Object(N.b)("areaResouse")(a=Object(N.c)((r=o=function(e){m()(a,e);var t,n=(t=a,function(){var e,n=w()(t);if(j()){var a=w()(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return g()(this,e)});function a(e){var t;return l()(this,a),t=n.call(this,e),b()(h()(t),"onSelect",(function(e,n){if(console.log(n),!e)return!1;t.selectNode={regionId:e,regionTitle:n.title,record:n.rowdata},t.props.onSearch(e,t.selectNode)})),b()(h()(t),"onUpdate",(function(){t.props.areaResouse.fetchRegion()})),t.selectNode={},t.state={selectNode:null,data:[]},t}return d()(a,[{key:"componentDidMount",value:function(){this.props.areaResouse.regionList.length<=0&&this.props.areaResouse.fetchRegion()}},{key:"render",value:function(){var e=this.props.areaResouse.regionList;return C.a.createElement(C.a.Fragment,null,C.a.createElement(k.a,{onChange:this.onSelect,placeholder:"请选择区域：地区-机房-区域",style:{width:300},onSearch:this.onSearch,allowClear:!0,showSearch:!0,filterOption:L.a.filterOption},x.a.map(e,(function(e){return C.a.createElement(P,{value:e.id,key:e.id,rowdata:e,title:e.locationCode}," ",e.locationCode," ")}))),C.a.createElement(s.a,{onClick:this.onUpdate},"更新区域"))}}]),a}(C.a.Component),b()(o,"propTypes",{areaResouse:E.a.any,onSearch:E.a.func,onClose:E.a.func,visible:E.a.bool,selectedIds:E.a.string}),a=r))||a)||a)||a;t.a=M},1601:function(e,t,n){"use strict";n(173);var a,o,r,i=n(84),s=n.n(i),c=(n(65),n(25)),l=n.n(c),u=(n(172),n(105)),d=n.n(u),f=(n(152),n(78)),h=n.n(f),p=n(15),m=n.n(p),y=n(19),g=n.n(y),v=n(6),w=n.n(v),S=n(20),b=n.n(S),I=n(21),k=n.n(I),R=n(13),C=n.n(R),O=n(2),E=n.n(O),N=n(0),D=n.n(N),x=n(1),L=n.n(x),j=(n(5),n(18)),P=n(1596),M=n(23),T=n(99),U=n(9),A=n(26);function F(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var _=Object(T.g)(a=Object(M.c)((r=o=function(e){b()(a,e);var t,n=(t=a,function(){var e,n=C()(t);if(F()){var a=C()(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return k()(this,e)});function a(e){var t;return m()(this,a),t=n.call(this,e),E()(w()(t),"onClose",(function(){t.setState({modalShow:!1})})),t.selectAreaNode={},t.state={lists:[],loading:!1,modalShow:!1,page:1,pageSize:20,total:0},t}return g()(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){}},{key:"getLog",value:function(e){var t=this;this.setState({loading:!0}),j.a.get("".concat(BSS_ADMIN_URL,"/api/product/usagerecord"),{params:{uLocationId:this.props.uLocationId}}).then((function(e){e=e.data,U.a.hasStatusOk(e)?t.setState({loading:!1,lists:e.data.records}):(U.a.dealFail(e),t.setState({loading:!1}))})).catch((function(){t.setState({loading:!1})}))}},{key:"onPageChange",value:function(e,t){this.getLog(e,t)}},{key:"onPageSizeChange",value:function(e,t){this.getLog(e,t)}},{key:"onModalShow",value:function(){this.setState({modalShow:!0}),this.getLog()}},{key:"makeColumns",value:function(){return[{title:"管理ip",dataIndex:"managementIp",key:"managementIp"},{title:"设备",dataIndex:"deviceName",key:"deviceName"},{title:"设备类型",dataIndex:"type",key:"type",render:function(e,t){return A.f.uw_facility[e]}},{title:"出库时间",dataIndex:"outboundTime",key:"outboundTime",render:function(e,t){return U.a.getTime(e)}}]}},{key:"render",value:function(){var e=this,t=this.state,n=t.lists,a=t.modalShow,o=t.loading,r=t.page,i=t.total;return D.a.createElement(D.a.Fragment,null,D.a.createElement("main",{className:"mian"},D.a.createElement(l.a,{title:"出库记录",maskClosable:!1,width:"80%",destroyOnClose:!0,onCancel:this.onClose,footer:null,visible:a},D.a.createElement("div",{className:"g-table"},D.a.createElement(h.a,{columns:this.makeColumns(),rowKey:function(e){return e.id},loading:o,dataSource:n}),D.a.createElement(d.a,{size:"small",current:r,total:i,showSizeChanger:!0,onChange:function(t,n){e.onPageChange(t,n)},onShowSizeChange:function(t,n){e.onPageSizeChange(t,n)}})))),D.a.createElement("span",{className:"control-btn green",onClick:function(){return e.onModalShow()}},D.a.createElement(s.a,{placement:"top",title:"出库记录"},D.a.createElement(P.a,null))))}}]),a}(D.a.Component),E()(o,"propTypes",{location:L.a.any,history:L.a.any,match:L.a.any,root:L.a.any,powers:L.a.array,data:L.a.any,uLocationId:L.a.string}),a=r))||a)||a;t.a=_},1622:function(e,t,n){"use strict";n(47);var a,o,r,i=n(17),s=n.n(i),c=n(15),l=n.n(c),u=n(19),d=n.n(u),f=n(6),h=n.n(f),p=n(20),m=n.n(p),y=n(21),g=n.n(y),v=n(13),w=n.n(v),S=n(2),b=n.n(S),I=(n(65),n(25)),k=n.n(I),R=(n(58),n(11)),C=n.n(R),O=(n(60),n(12)),E=n.n(O),N=n(0),D=n.n(N),x=n(1),L=n.n(x),j=n(23),P=n(5),M=n.n(P),T=(n(18),n(9));n(28);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}E.a.Item;var F=C.a.Option,_=(k.a.confirm,Object(j.b)("root")(a=Object(j.b)("areaResouse")(a=Object(j.c)((r=o=function(e){m()(a,e);var t,n=(t=a,function(){var e,n=w()(t);if(A()){var a=w()(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return g()(this,e)});function a(e){var t;return l()(this,a),t=n.call(this,e),b()(h()(t),"onSelect",(function(e,n){if(console.log(n),!e)return!1;t.selectNode=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n.rowdata),t.props.onSearch(e,t.selectNode)})),b()(h()(t),"onUpdate",(function(){t.props.areaResouse.fetchVarea()})),t.selectNode={},t.state={selectNode:null,data:[]},t}return d()(a,[{key:"componentDidMount",value:function(){this.props.areaResouse.vareaList.length<=0&&this.props.areaResouse.fetchVarea()}},{key:"render",value:function(){var e=this.props.areaResouse.vareaList;return D.a.createElement(D.a.Fragment,null,D.a.createElement(C.a,{onChange:this.onSelect,placeholder:"请选择区域：地区-机房-区域",style:{width:300},allowClear:!0,showSearch:!0,defaultValue:this.props.defaultKey,filterOption:T.a.filterOption},M.a.map(e,(function(e){return D.a.createElement(F,{value:e.fullLocationId,key:e.fullLocationId,rowdata:e,title:e.fullLocationName}," ",e.fullLocationName," ")}))),D.a.createElement(s.a,{onClick:this.onUpdate},"更新区域"))}}]),a}(D.a.Component),b()(o,"propTypes",{areaResouse:L.a.any,onSearch:L.a.func,onClose:L.a.func,defaultKey:L.a.string}),a=r))||a)||a)||a);t.a=_},1623:function(e,t,n){"use strict";n(152);var a,o,r,i,s=n(78),c=n.n(s),l=(n(47),n(17)),u=n.n(l),d=(n(65),n(25)),f=n.n(d),h=n(15),p=n.n(h),m=n(19),y=n.n(m),g=n(6),v=n.n(g),w=n(20),S=n.n(w),b=n(21),I=n.n(b),k=n(13),R=n.n(k),C=n(2),O=n.n(C),E=(n(416),n(192)),N=n.n(E),D=(n(58),n(11)),x=n.n(D),L=(n(98),n(55)),j=n.n(L),P=(n(60),n(12)),M=n.n(P),T=n(0),U=n.n(T),A=n(1),F=n.n(A),_=(n(5),n(18)),z=n(23),K=n(99),B=(n(3),n(28),n(26)),V=n(9);n(153),n(1599);function J(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}M.a.Item,j.a.TextArea,x.a.Option,N.a.TreeNode;var W=(a=Object(z.b)("root"),Object(K.g)(o=a((i=r=function(e){S()(a,e);var t,n=(t=a,function(){var e,n=R()(t);if(J()){var a=R()(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return I()(this,e)});function a(e){var t;return p()(this,a),t=n.call(this,e),O()(v()(t),"formRefAdd",U.a.createRef()),O()(v()(t),"onResetSearch",(function(){t.formRefAdd.current.resetFields()})),O()(v()(t),"onClose",(function(){t.setState({showModal:!1})})),t.selectAreaNode={},t.selectedRows=[],t.uw=0,t.state={fetchPath:t.props.fetchPath,nwoData:{},orgionLists:[],lists:[],loading:!1,showModal:!1,cabinetName:""},t}return y()(a,[{key:"getDetail",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setState({loading:!0}),_.a.get(this.props.fetchPath,{params:t}).then((function(t){t=t.data,V.a.hasStatusOk(t)?e.setState({loading:!1,lists:t.data,orgionLists:t.data}):(V.a.dealFail(t),e.setState({loading:!1}))})).catch((function(){e.setState({loading:!1})}))}},{key:"selectedRow",value:function(e,t){this.selectedRows=t,this.props.onSelect(e,t),this.setState({showModal:!1,cabinetName:t[0].name})}},{key:"modalShow",value:function(){if(this.props.disabled)return f.a.error({title:this.props.disabledTip}),!1;this.getDetail(),this.setState({showModal:!0})}},{key:"makeColumns",value:function(){return[{title:"机柜名称",dataIndex:"name",width:150,key:"name"},{title:"位置码",dataIndex:"physicsLocationCode",key:"physicsLocationCode"},{title:"行/列",dataIndex:"row",key:"row",render:function(e,t){return"".concat(t.row,"/").concat(t.coulmn)}},{title:"规格",dataIndex:"spec",key:"spec"},{title:"机柜属性",dataIndex:"attribute",width:100,key:"attribute",render:function(e,t){return B.a.cabinet_attribute[e]||"未知属性"}},{title:"总U位数",dataIndex:"us",key:"us"},{title:"剩余U位",dataIndex:"usremain",key:"usremain"},{title:"剩余最大U位数",dataIndex:"usmaxremain",key:"usmaxremain"},{title:"备注",dataIndex:"remark",key:"remark"}]}},{key:"render",value:function(){var e=this,t=this.state,n=t.lists,a=t.showModal,o=t.loading;t.cabinetName;return U.a.createElement("main",{className:"mian"},U.a.createElement(f.a,{title:this.props.title||"选择机柜",maskClosable:!1,width:"90%",destroyOnClose:!0,footer:!1,onOk:this.onModalOk,onCancel:this.onClose,visible:a},U.a.createElement("div",{className:"g-search"},U.a.createElement(M.a,{ref:this.searchFormRef,name:"searchbox",layout:"inline",onFinish:function(t){e.getDetail(t)}},U.a.createElement(M.a.Item,{name:"name"},U.a.createElement(j.a,{placeholder:"机柜名称",allowClear:!0})),U.a.createElement(M.a.Item,null,U.a.createElement(u.a,{type:"primary",htmlType:"submit"},"搜索")))),U.a.createElement("div",{className:"g-table"},U.a.createElement(c.a,{columns:this.makeColumns(),rowKey:function(e){return e.id},loading:o,dataSource:n,pagination:!1,rowSelection:{type:"radio",onChange:function(t,n){e.selectedRow(t,n)}}}))),U.a.createElement("span",{onClick:function(){e.modalShow()}},this.props.children))}}]),a}(U.a.Component),O()(r,"propTypes",{location:F.a.any,history:F.a.any,match:F.a.any,root:F.a.any,children:F.a.any,title:F.a.string,uw:F.a.number,disabled:F.a.bool,disabledTip:F.a.string,style:F.a.any,fetchPath:F.a.string,powers:F.a.array,defaultData:F.a.any,onSelect:F.a.func}),o=i))||o)||o);t.a=W},1629:function(e,t,n){"use strict";n(152);var a,o,r,i,s,c=n(78),l=n.n(c),u=(n(254),n(116)),d=n.n(u),f=(n(65),n(25)),h=n.n(f),p=n(15),m=n.n(p),y=n(19),g=n.n(y),v=n(6),w=n.n(v),S=n(20),b=n.n(S),I=n(21),k=n.n(I),R=n(13),C=n.n(R),O=n(2),E=n.n(O),N=(n(416),n(192)),D=n.n(N),x=(n(58),n(11)),L=n.n(x),j=(n(98),n(55)),P=n.n(j),M=(n(60),n(12)),T=n.n(M),U=n(0),A=n.n(U),F=n(1),_=n.n(F),z=n(5),K=n.n(z),B=n(18),V=n(23),J=n(99),W=n(26),q=n(9),G=(n(153),n(1601)),H=n(1622),Q=n(1623);function X(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}T.a.Item,P.a.TextArea,L.a.Option,D.a.TreeNode;var Y=(a=Object(V.b)("root"),o=Object(V.b)("cabinetDict"),Object(J.g)(r=a(r=o(r=Object(V.c)((s=i=function(e){b()(a,e);var t,n=(t=a,function(){var e,n=C()(t);if(X()){var a=C()(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return k()(this,e)});function a(e){var t;return m()(this,a),t=n.call(this,e),E()(w()(t),"formRefAdd",A.a.createRef()),E()(w()(t),"onResetSearch",(function(){t.formRefAdd.current.resetFields()})),E()(w()(t),"onClose",(function(){t.setState({showModal:!1})})),E()(w()(t),"mergeCells2",(function(e,n,a){var o=t.state.lists;if(0!==a&&e===o[a-1][n])return 0;for(var r=1,i=a+1;i<o.length&&e===o[i][n];i++)r++;return r})),t.selectedRows=[],t.cabinetInfo={},t.regionInfo={},t.state={nowData:{},lists:[],loading:!1,showModal:!1,regionId:"",cabinetId:"",uw:void 0},t}return g()(a,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){}},{key:"getDetail",value:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setState({loading:!0}),B.a.get("".concat(BSS_ADMIN_URL,"/api/product/cabinet/").concat(e,"/get")).then((function(e){if(e=e.data,q.a.hasStatusOk(e)){var n=e.data.ulocationList;t.uList=n,t.setState({nowData:e.data,loading:!1,lists:n})}else q.a.dealFail(e),t.setState({loading:!1})})).catch((function(){t.setState({loading:!1})}))}},{key:"selectedRow",value:function(e,t){var n=this.props.uw,a=this.uList.length,o=t[0].uw;if(a<o+n-1)return h.a.error({title:"大于总U位数,请从新选择起始U位!"}),!1;for(var r=a-o,i=a-n-o+1,s=K.a.slice(this.uList,i,r+1),c=0;c<n;c++)if("1"!=s[c].status)return h.a.error({title:"U位被占用或大于总U位数,请从新选择起始U位!"}),!1;this.selectedRows=t,this.props.onSelect({regionId:this.state.regionId,regionInfo:this.regionInfo,cabinetInfo:this.cabinetInfo,uBitInfo:t[0]}),this.setState({showModal:!1})}},{key:"getRegion",value:function(e,t){e?(this.regionInfo=t,this.cabinetInfo={},this.setState({lists:[],regionId:t.regionId,cabinetId:void 0})):(this.regionInfo={},this.cabinetInfo={},this.setState({lists:[],regionId:void 0,cabinetId:void 0}))}},{key:"getCabinet",value:function(e,t){this.cabinetInfo=t[0],this.setState({cabinetId:e}),this.getDetail(e)}},{key:"modalShow",value:function(){if(!this.props.uw)return h.a.error({title:"请输入U位数"}),!1;this.props.uw!==this.state.uw?(this.selectedRows=[],this.regionInfo={},this.cabinetInfo={},this.setState({nowData:{},lists:[],regionId:void 0,cabinetId:void 0,uw:this.props.uw,showModal:!0})):this.setState({showModal:!0})}},{key:"makeColumns",value:function(){var e=this;this.state.lists.length;return[{title:"u位",dataIndex:"uw",width:80,key:"uw"},{title:"管理ip",dataIndex:"managerIp",width:150,key:"managerIp",render:function(t,n,a){if(n.deviceId){var o={children:null!==t?t:"",props:{}};return o.props.rowSpan=e.mergeCells2(n.deviceId,"deviceId",a),e.rowSpan=o.props.rowSpan,o}return{children:null!==t?t:"",rowSpan:0}}},{title:"设备",dataIndex:"deviceName",key:"deviceName",render:function(t,n,a){if(t=null!==t?t:"",n.deviceId){var o={children:t,props:{}};return o.props.rowSpan=e.rowSpan,o}return{children:t,rowSpan:0}}},{title:"预约客户",dataIndex:"customerName",key:"customerName",render:function(t,n,a){if(n.deviceId){var o={children:t,props:{}};return o.props.rowSpan=e.rowSpan,o}if(n.customerName){var r={children:t,props:{}};return r.props.rowSpan=e.mergeCells2(n.customerName,"customerName",a),e.rowSpan=r.props.rowSpan,r}return{children:t,rowSpan:0}}},{title:"使用状态",dataIndex:"status",width:100,key:"status",render:function(t,n,a){var o=parseInt(t);if(n.deviceId){var r={children:q.a.renderStatus(W.a.uw_status,o),props:{}};return r.props.rowSpan=e.rowSpan,r}if(n.customerName){var i={children:q.a.renderStatus(W.a.uw_status,o),props:{}};return i.props.rowSpan=e.mergeCells2(n.customerName,"customerName",a),e.rowSpan=i.props.rowSpan,i}return{children:q.a.renderStatus(W.a.uw_status,o),rowSpan:0}}},{title:"出库记录",key:"control",fixed:"right",width:160,render:function(e,t){var n=[];n.push(A.a.createElement(G.a,{uLocationId:t.id}));var a=[];return n.forEach((function(e,t){t&&a.push(A.a.createElement(d.a,{key:"line".concat(t),type:"vertical"})),a.push(e)})),a}}]}},{key:"render",value:function(){var e=this,t=this.state,n=t.lists,a=t.showModal,o=t.loading;return A.a.createElement(A.a.Fragment,null,A.a.createElement(h.a,{title:this.props.title||"选择U位",maskClosable:!1,width:"95%",destroyOnClose:!0,footer:null,onCancel:this.onClose,visible:a},A.a.createElement("main",{className:"mian"},A.a.createElement("div",{className:"g-search"},A.a.createElement(H.a,{defaultKey:this.regionInfo&&this.regionInfo.fullLocationId,onSearch:function(t,n){e.getRegion(t,n)}}),A.a.createElement("div",{style:{display:"inline-block",width:200,marginLeft:10}},A.a.createElement(Q.a,{title:"选择机柜",disabled:!this.state.regionId&&this.props.uw,disabledTip:"请先选择区域",fetchPath:"".concat(BSS_ADMIN_URL,"/api/product/cabinet/choose?us=").concat(this.props.uw,"&regionId=").concat(this.state.regionId),onSelect:function(t,n){e.getCabinet(t,n)}},A.a.createElement(P.a,{placeholder:"选择机柜",value:this.cabinetInfo.name})))),A.a.createElement("div",{className:"g-table"},A.a.createElement(l.a,{columns:this.makeColumns(),rowKey:function(e){return e.id},loading:o,dataSource:n,pagination:!1,size:"small",rowSelection:{type:"radio",onChange:function(t,n){e.selectedRow(t,n)},getCheckboxProps:function(e){return{disabled:1!=e.status,status:e.status}}}})))),A.a.createElement("span",{onClick:function(){e.modalShow()}},this.props.children))}}]),a}(A.a.Component),E()(i,"propTypes",{location:_.a.any,history:_.a.any,match:_.a.any,root:_.a.any,cabinetDict:_.a.any,powers:_.a.array,defaultData:_.a.any,onOk:_.a.func,onClose:_.a.func}),r=s))||r)||r)||r)||r);t.a=Y}}]);