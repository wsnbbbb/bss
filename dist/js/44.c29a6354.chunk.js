(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{1572:function(e,t,a){"use strict";a.r(t);a(136);var n,i,r,o,s=a(34),l=a.n(s),c=a(15),u=a.n(c),d=a(19),p=a.n(d),m=a(6),h=a.n(m),f=a(20),y=a.n(f),g=a(21),k=a.n(g),v=a(13),S=a.n(v),E=a(2),C=a.n(E),I=(a(81),a(37)),w=a.n(I),b=a(0),O=a.n(b),N=a(1),R=a.n(N),_=a(5),z=a.n(_),P=a(18),L=a(9),D=a(23),M=a(141),T=(a(194),a(106)),K=a.n(T),j=(a(154),a(31)),x=a.n(j),A=(a(172),a(105)),G=a.n(A),H=(a(174),a(107)),F=a.n(H),U=(a(47),a(17)),B=a.n(U),J=(a(60),a(12)),q=a.n(J),Q=(a(58),a(11)),V=a.n(Q),W=(a(65),a(25)),X=a.n(W),Y=(a(28),a(26)),Z=(a(52),a(125)),$=a.n(Z),ee=a(167);function te(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ae(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?te(Object(a),!0).forEach((function(t){C()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):te(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ne(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}X.a.confirm;var ie,re,oe,se=V.a.Option,le=(n=Object(D.b)("areaResouse"),Object(D.c)(i=n((o=r=function(e){y()(n,e);var t,a=(t=n,function(){var e,a=S()(t);if(ne()){var n=S()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return k()(this,e)});function n(e){var t;return u()(this,n),t=a.call(this,e),C()(h()(t),"searchFormRef",O.a.createRef()),C()(h()(t),"onGetListData",(function(e){var a=z.a.assign({},{page:t.state.page,pageSize:t.state.pageSize,houseId:t.props.houseId},t.searchParam,ae({},e));t.setState({loading:!0}),P.a.get("".concat(BSS_ADMIN_URL,"/api/goods/diskprice"),{params:L.a.clearEmpty(a)}).then((function(e){e=e.data,L.a.hasStatusOk(e)?t.setState({lists:e.data.records,total:e.data.total}):L.a.dealFail(e),t.setState({loading:!1})})).catch((function(){t.setState({loading:!1})}))})),C()(h()(t),"onResetSearch",(function(){t.searchFormRef.current.resetFields()})),C()(h()(t),"onModalOk",(function(){var e={},a="".concat(BSS_ADMIN_URL,"/api/goods/diskprice"),n=t.state,i=n.type,r=n.copyedHouseId,o=n.config,s=n.price;if(null!=i){if(1==i){if(!r)return void X.a.error({title:"请选择机房"});if(r==t.props.houseId)return void X.a.error({title:"不能选择相同的机房作为复制源"});e.houseId=t.props.houseId,a="".concat(a,"/").concat(i,"/").concat(r,"/addbatch")}else{if(!s)return void X.a.error({title:"请输入价格"});a="".concat(a,"/").concat(i,"/null/addbatch"),e=ae({},e,{},o,{houseId:t.props.houseId,price:s,currency:1})}t.setState({loading:!0}),P.a.post("".concat(a),e).then((function(e){e=e.data,L.a.hasStatusOk(e)?(t.onGetListData(),t.onModalClose()):L.a.dealFail(e),t.setState({loading:!1})})).catch((function(){t.setState({loading:!1})}))}else X.a.error({title:"请选择快速设置方式"})})),C()(h()(t),"onChangeType",(function(e){t.setState({type:e.target.value})})),C()(h()(t),"onModalClose",(function(){t.setState({modalShow:!1})})),C()(h()(t),"onChangeConfig",(function(e,a){var n=ae({},t.state.config);n[e]=a,t.setState({config:n})})),C()(h()(t),"setOriginHouse",(function(e){t.setState({copyedHouseId:e})})),C()(h()(t),"setPrice",(function(e){t.setState({price:e})})),t.searchParam={},t.state={lists:[],loading:!1,page:1,pageSize:20,total:0,modalShow:!1,modalLoading:!1,type:void 0,config:{},price:void 0,copyedHouseId:void 0,hasPriceHouse:[]},t.setPrice=$()(t.setPrice,800),t}return p()(n,[{key:"componentDidMount",value:function(){this.props.activeKey&&this.props.activeKey==this.props.houseId&&this.onGetListData()}},{key:"onSearch",value:function(e){this.searchParam=e,this.setState({page:1}),this.onGetListData(e)}},{key:"onPageChange",value:function(e,t){this.setState({page:e}),this.onGetListData({page:e,pageSize:t})}},{key:"onPageSizeChange",value:function(e,t){this.setState({page:e,pageSize:t}),this.onGetListData({page:e,pageSize:t})}},{key:"onModalShow",value:function(){var e=this,t=this.props.areaResouse.houseList;P.a.get("".concat(BSS_ADMIN_URL,"/api/goods/cpuprice/4/price_house")).then((function(a){if(a=a.data,L.a.hasStatusOk(a)){var n=z.a.filter(t,(function(e){return z.a.includes(a.data,e.id)}));e.setState({modalLoading:!1,hasPriceHouse:n})}else e.setState({modalLoading:!1}),L.a.dealFail(a)})).catch((function(){e.setState({modalLoading:!1})})),this.setState({modalShow:!0,config:{}})}},{key:"render",value:function(){var e=this,t=[{title:"配置",dataIndex:"configName",key:"configName"},{title:"类型",dataIndex:"diskShort",key:"diskShort",render:function(e){return Y.k.disk_short[e]}},{title:"接口",dataIndex:"interfaceType",key:"interfaceType",render:function(e){return Y.k.disk_interface_type[e]}},{title:"容量(G)",dataIndex:"diskSize",key:"diskSize"},{title:"规格",dataIndex:"diskMeasure",key:"diskMeasure",render:function(e){return Y.k.server_disk_spec[e]}},{title:"用途",dataIndex:"useType",key:"useType",render:function(e){return Y.k.use_type[e]}},{title:"基础价(/月)",dataIndex:"price",key:"price"},{title:"币种",dataIndex:"currency",key:"currency",render:function(e){return Y.b.currency[e]||""}}],a=this.state,n=a.lists,i=a.page,r=a.pageSize,o=a.total,s=a.loading,l=a.hasPriceHouse,c=this.props.diskSize;return O.a.createElement("main",{className:"mian"},O.a.createElement("div",{className:"g-search"},O.a.createElement(q.a,{ref:this.searchFormRef,name:"searchbox",layout:"inline",onFinish:function(t){e.onSearch(t)}},O.a.createElement(q.a.Item,{name:"diskShort"},O.a.createElement(V.a,{style:{width:200},placeholder:"硬盘类型",allowClear:!0},z.a.map(Y.k.disk_short,(function(e,t){return O.a.createElement(se,{value:parseInt(t),key:t}," ",e," ")})))),O.a.createElement(q.a.Item,{name:"interfaceType"},O.a.createElement(V.a,{style:{width:150},placeholder:"硬盘接口类型",allowClear:!0},z.a.map(Y.k.disk_interface_type,(function(e,t){return O.a.createElement(se,{value:parseInt(t),key:t}," ",e," ")})))),O.a.createElement(q.a.Item,{name:"diskSize"},O.a.createElement(V.a,{style:{width:200},placeholder:"容量",allowClear:!0},z.a.map(c,(function(e,t){return O.a.createElement(se,{value:e,key:e}," ",e," ")})))),O.a.createElement(q.a.Item,{name:"diskMeasure"},O.a.createElement(V.a,{style:{width:200},placeholder:"规格",allowClear:!0},z.a.map(Y.k.server_disk_spec,(function(e,t){return O.a.createElement(se,{value:parseInt(t),key:t}," ",e," ")})))),O.a.createElement(q.a.Item,{name:"useType"},O.a.createElement(V.a,{style:{width:200},placeholder:"用途",allowClear:!0},z.a.map(Y.k.use_type,(function(e,t){return O.a.createElement(se,{value:parseInt(t),key:t}," ",e," ")})))),O.a.createElement(q.a.Item,null,O.a.createElement(B.a,{type:"primary",htmlType:"submit"},"搜索")),O.a.createElement(q.a.Item,null,O.a.createElement(B.a,{type:"primary",onClick:this.onResetSearch},"重置")))),O.a.createElement("div",{className:"g-operate"},O.a.createElement(B.a,{className:"actions-btn",size:"middle",onClick:function(){e.onModalShow()}},"快速设置"),O.a.createElement(B.a,{className:"actions-btn",size:"middle",onClick:function(){e.onGetListData()}},"刷新列表")),O.a.createElement("div",{className:"g-table"},O.a.createElement(F.a,{spinning:s},O.a.createElement(ee.a,{data:n,postData:{houseId:this.props.houseId},postUrl:"".concat(BSS_ADMIN_URL,"/api/goods/diskprice"),columns:t,updateList:this.onGetListData})),O.a.createElement("div",{className:"g-pagination"},O.a.createElement(G.a,{current:i,total:o,pageSize:r,showSizeChanger:!0,showTotal:function(e){return"共 ".concat(e," 条")},onChange:function(t,a){e.onPageChange(t,a)},onShowSizeChange:function(t,a){e.onPageSizeChange(t,a)}}))),O.a.createElement(X.a,{title:"快速设置",maskClosable:!1,width:"700px",onOk:this.onModalOk,destroyOnClose:!0,onCancel:this.onModalClose,visible:this.state.modalShow,modalLoading:this.state.modalLoading},O.a.createElement("div",{className:"fileds-form"},O.a.createElement(x.a.Group,{value:this.state.type,onChange:this.onChangeType},O.a.createElement(x.a,{value:1},O.a.createElement("span",{style:{paddingRight:20}},"从已设置机房复制"),O.a.createElement(V.a,{style:{width:400},onChange:this.setOriginHouse,allowClear:!0,filterOption:L.a.filterOption},z.a.map(l,(function(e){return O.a.createElement(V.a.Option,{key:e.id,value:e.id},e.fullName)})))),O.a.createElement("div",{style:{marginTop:20}},O.a.createElement(x.a,{value:2},O.a.createElement("span",null,"选择参数批量设置"),O.a.createElement("div",{className:"fileds"},O.a.createElement("div",{className:"filed"},O.a.createElement("span",{className:"filed-lable"},"硬盘类型"),O.a.createElement(V.a,{onChange:function(t){e.onChangeConfig("diskShort",t)},style:{width:200},placeholder:"硬盘类型",allowClear:!0},O.a.createElement(V.a.Option,{value:null,key:null},"任意"),z.a.map(Y.k.disk_short,(function(e,t){return O.a.createElement(se,{value:parseInt(t),key:t}," ",e," ")})))),O.a.createElement("div",{className:"filed"},O.a.createElement("span",{className:"filed-lable"},"硬盘接口类型"),O.a.createElement(V.a,{onChange:function(t){e.onChangeConfig("interfaceType",t)},style:{width:150},placeholder:"硬盘接口类型",allowClear:!0},O.a.createElement(V.a.Option,{value:null,key:null},"任意"),z.a.map(Y.k.disk_interface_type,(function(e,t){return O.a.createElement(se,{value:parseInt(t),key:t}," ",e," ")})))),O.a.createElement("div",{className:"filed"},O.a.createElement("span",{className:"filed-lable"},"容量"),O.a.createElement(V.a,{onChange:function(t){e.onChangeConfig("diskSize",t)},style:{width:200},placeholder:"容量",allowClear:!0},O.a.createElement(V.a.Option,{value:null,key:null},"任意"),z.a.map(c,(function(e,t){return O.a.createElement(se,{value:parseInt(t),key:t}," ",e," ")})))),O.a.createElement("div",{className:"filed"},O.a.createElement("span",{className:"filed-lable"},"规格"),O.a.createElement(V.a,{onChange:function(t){e.onChangeConfig("diskMeasure",t)},style:{width:200},placeholder:"规格",allowClear:!0},O.a.createElement(V.a.Option,{value:null,key:null},"任意"),z.a.map(Y.k.server_disk_spec,(function(e,t){return O.a.createElement(se,{value:parseInt(t),key:t}," ",e," ")})))),O.a.createElement("div",{className:"filed"},O.a.createElement("span",{className:"filed-lable"},"用途"),O.a.createElement(V.a,{onChange:function(t){e.onChangeConfig("useType",t)},style:{width:200},placeholder:"用途",allowClear:!0},O.a.createElement(V.a.Option,{value:null,key:null},"任意"),z.a.map(Y.k.use_type,(function(e,t){return O.a.createElement(se,{value:parseInt(t),key:t}," ",e," ")})))),O.a.createElement("div",{className:"filed"},O.a.createElement("span",{className:"filed-lable"},"基础价(人民币)"),O.a.createElement(K.a,{onChange:this.setPrice})))))))))}}]),n}(O.a.Component),C()(r,"propTypes",{location:R.a.any,history:R.a.any,userinfo:R.a.any,diskSize:R.a.any,models:R.a.any,activeKey:R.a.string,houseId:R.a.string}),i=o))||i)||i);a(220);function ce(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ue=w.a.TabPane,de=Object(D.b)("areaResouse")((oe=re=function(e){y()(n,e);var t,a=(t=n,function(){var e,a=S()(t);if(ce()){var n=S()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return k()(this,e)});function n(e){var t;return u()(this,n),t=a.call(this,e),C()(h()(t),"handleModeChange",(function(e){var a=e.target.value;t.setState({mode:a})})),C()(h()(t),"callback",(function(e){sessionStorage.setItem("roomkey",e),t.setState({activeKey:e+""})})),C()(h()(t),"setActiveKey",(function(e){t.setState({activeKey:e+""})})),t.props.areaResouse.houseList.length<=0&&t.props.areaResouse.fetchHouse(),t.state={mode:"top",activeKey:sessionStorage.getItem("roomkey"),diskSize:[]},t}return p()(n,[{key:"componentDidMount",value:function(){this.fetchdiskSize(),this.props.areaResouse.houseList.length<=0&&this.props.areaResouse.fetchHouse()}},{key:"fetchdiskSize",value:function(){var e=this;this.setState({loading:!0}),P.a.get("".concat(BSS_ADMIN_URL,"/api/product/diskmodel/disksize")).then((function(t){t=t.data,L.a.hasStatusOk(t)?e.setState({diskSize:t.data}):L.a.dealFail(t)})).catch((function(){}))}},{key:"render",value:function(){var e=this.state,t=e.mode,a=e.activeKey,n=e.diskSize,i=this.props.areaResouse.houseList,r=a||i[0]&&i[0].id&&i[0].id+"";return console.log("render index"),O.a.createElement("div",{className:"mian"},O.a.createElement("div",{className:"bread"},O.a.createElement(l.a,null,O.a.createElement(l.a.Item,null,"产品管理"),O.a.createElement(l.a.Item,null,"价格管理"),O.a.createElement(l.a.Item,null,"硬盘")),O.a.createElement(M.a,{houseList:i,setActiveKey:this.setActiveKey,init_activeKey:r})),O.a.createElement(w.a,{defaultActiveKey:r,tabPosition:t,onChange:this.setActiveKey,activeKey:r},z.a.map(i,(function(e){return O.a.createElement(ue,{tab:e.fullName,key:e.id},O.a.createElement(le,{houseId:e.id,activeKey:r,diskSize:n}))}))))}}]),n}(O.a.Component),C()(re,"propTypes",{location:R.a.any,history:R.a.any,areaResouse:R.a.any}),ie=oe))||ie;t.default=de}}]);