(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{1664:function(t,e,n){},1665:function(t,e,n){var o;window,t.exports=(o=n(0),function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var s=i(n(2));n(3).polyfill();var a=function(t){function e(e){var n,o=t.call(this,e)||this;return o.state={id:o.props.id||(new Date).getTime()+"_"+Math.random().toFixed(4),width:o.props.width||150,height:o.props.height||40,len:o.props.length||4,style:(n={position:"relative",backgroundColor:"#fff",overflow:"hidden",width:o.props.width?o.props.width+"px":"150px",height:o.props.height?o.props.height+"px":"40px",cursor:"pointer",verticalAlign:"middle",userSelect:"none"},o.props.style?Object.assign({},n,o.props.style):n),options:function(){var t={codes:["a","b","c","d","e","f","g","h","i","j","k","l","m","o","p","q","r","s","t","x","u","v","y","z","w","n","0","1","2","3","4","5","6","7","8","9"],fontSizeMin:22,fontSizeMax:26,colors:["#117cb3","#f47b06","#202890","#db1821","#b812c2"],fonts:["Times New Roman","Georgia","Serif","sans-serif","arial","tahoma","Hiragino Sans GB"],lines:8,lineColors:["#7999e1","#383838","#ec856d","#008888"],lineHeightMin:1,lineHeightMax:1,lineWidthMin:20,lineWidthMax:60};return o.props.options?Object.assign({},t,o.props.options):t}()},o}return r(e,t),e.prototype.componentDidMount=function(){this.onDraw(this.props.value)},e.prototype.componentDidUpdate=function(t){this.props.value!==t.value&&this.onDraw(this.props.value),this.props.width===t.width&&this.props.height===t.height&&this.props.style===t.style||this.setState({width:this.props.width||150,height:this.props.height||40,style:Object.assign({},this.state.style,{width:this.props.width?this.props.width+"px":"150px",height:this.props.height?this.props.height+"px":"40px"})})},e.prototype.onClick=function(){this.props.value||this.onDraw(this.props.value),this.props.onClick&&this.props.onClick()},e.prototype.codeCss=function(t,e){return["font-size:"+this.randint(this.state.options.fontSizeMin,this.state.options.fontSizeMax)+"px","color:"+this.state.options.colors[this.randint(0,this.state.options.colors.length-1)],"position: absolute","left:"+this.randint(t*e,t*e+t-t/2)+"px","top:50%","transform:rotate("+this.randint(-15,15)+"deg) translateY(-50%)","-o-transform:rotate("+this.randint(-15,15)+"deg) translateY(-50%)","-ms-transform:rotate("+this.randint(-15,15)+"deg) translateY(-50%)","-moz-transform:rotate("+this.randint(-15,15)+"deg) translateY(-50%)","-webkit-transform:rotate("+this.randint(-15,15)+"deg) translateY(-50%)","font-family:"+this.state.options.fonts[this.randint(0,this.state.options.fonts.length-1)],"font-weight:bold","z-index:2"].join(";")},e.prototype.lineCss=function(){return["position: absolute","opacity:"+this.randint(3,8)/10,"width:"+this.randint(this.state.options.lineWidthMin,this.state.options.lineWidthMax)+"px","height:"+this.randint(this.state.options.lineHeightMin,this.state.options.lineHeightMax)+"px","background:"+this.state.options.lineColors[this.randint(0,this.state.options.lineColors.length-1)],"left:"+this.randint(-this.state.options.lineWidthMin/2,this.state.width)+"px","top:"+this.randint(0,this.state.height)+"px","transform:rotate("+this.randint(-30,30)+"deg)","-o-transform:rotate("+this.randint(-30,30)+"deg)","-ms-transform:rotate("+this.randint(-30,30)+"deg)","-moz-transform:rotate("+this.randint(-30,30)+"deg)","-webkit-transform:rotate("+this.randint(-30,30)+"deg)","font-family:"+this.state.options.fonts[this.randint(0,this.state.options.fonts.length-1)],"font-weight:"+this.randint(400,900)].join(";")},e.prototype.onDraw=function(t){var e="",n=document.getElementById(this.state.id),o=/^http[s]*:\/\/|\.jpg$|\.png$|\.jpeg$|\.gif$|\.bmp$|\.webp$|^data:image/.test(t||"");if(n.innerHTML="",o)return(c=document.createElement("img")).style.cssText=["display: block","max-width:100%","max-height:100%"].join(";"),c.src=t,n.appendChild(c),this.props.onChange&&this.props.onChange(null),null;for(var r=t?t.length:this.state.len,i=this.state.width/r/1.01,s=0;s<r;s++){(c=document.createElement("span")).style.cssText=this.codeCss(i,s);var a=t?t[s]:this.state.options.codes[Math.round(Math.random()*(this.state.options.codes.length-1))];c.innerHTML=String(a),e=""+e+a,n.appendChild(c)}for(s=0;s<this.state.options.lines;s++){var c;(c=document.createElement("div")).style.cssText=this.lineCss(),n.appendChild(c)}return this.props.onChange&&this.props.onChange(e),e},e.prototype.randint=function(t,e){var n=e-t+1,o=Math.random()*n+t;return Math.floor(o)},e.prototype.render=function(){var t=this;return s.createElement("div",{id:this.state.id,style:this.state.style,className:this.props.className,onClick:function(){return t.onClick()}})},e}(s.PureComponent);e.default=a},function(t,e){t.exports=o},function(t,e,n){"use strict";function o(t,e){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),o=1;o<arguments.length;o++){var r=arguments[o];if(null!=r)for(var i=Object.keys(Object(r)),s=0,a=i.length;s<a;s++){var c=i[s],p=Object.getOwnPropertyDescriptor(r,c);void 0!==p&&p.enumerable&&(n[c]=r[c])}}return n}t.exports={assign:o,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:o})}}}]))},1720:function(t,e,n){},1721:function(t,e,n){t.exports=n.p+"assets/imgs/29e84795cc0e980cf27c412914526a7d.png"},1925:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return et}));var o,r,i,s=n(15),a=n.n(s),c=n(19),p=n.n(c),u=n(6),l=n.n(u),d=n(20),h=n.n(d),f=n(21),g=n.n(f),m=n(13),y=n.n(m),v=n(2),w=n.n(v),b=(n(81),n(37)),x=n.n(b),M=n(0),S=n.n(M),k=n(1),E=n.n(k),_=n(9),j=n(134),C=n.n(j),O=(n(1664),n(1665),n(727),n(47),n(17)),P=n.n(O),I=(n(98),n(55)),T=n.n(I),R=n(4),D=n.n(R),L=n(218),z=n.n(L),N=n(44),A=n.n(N),B=(n(132),n(35)),H=n.n(B),U=(n(60),n(12)),W=n.n(U),$=n(23),F=(n(3),n(99)),J=n(52);n(24);function Y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var q=W.a.Item,V=Object($.b)("root")(o=Object($.b)("authManage")((i=r=function(t){h()(r,t);var e,n,o=(e=r,function(){var t,n=y()(e);if(Y()){var o=y()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return g()(this,t)});function r(t){var e;return a()(this,r),e=o.call(this,t),w()(l()(e),"onFinish",(function(t){e.setState({loading:!0}),e.loginIn(t).then((function(n){200===n.status?(H.a.success("登录成功"),e.props.root.setUserInfo(n.data),e.state.rememberPassword?localStorage.setItem("userLoginInfo",JSON.stringify({username:t.username,password:_.a.compile(t.password)})):localStorage.removeItem("userLoginInfo"),sessionStorage.setItem("userinfo",_.a.compile(JSON.stringify(n.data))),e.props.root.setUserInfo(n.data),setTimeout((function(){return e.props.history.replace("/")}))):H.a.error(n.message)})).finally((function(t){e.setState({loading:!1})}))})),e.state={loading:!1,rememberPassword:!1,codeValue:"00000",show:!1},e}return p()(r,[{key:"componentDidMount",value:function(){console.log("componentDidMount");var t=this.props.form,e=localStorage.getItem("userLoginInfo");e&&(e=JSON.parse(e),this.setState({rememberPassword:!0}),t.setFieldsValue({username:e.username,password:_.a.uncompile(e.password)})),this.setState({show:!0})}},{key:"loginIn",value:(n=A()(D.a.mark((function t(e){var n,o,r,i,s,a,c,p,u,l;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=null,o=[],r=[],i=[],s="",t.next=7,this.props.root.onLogin(e);case 7:if((a=t.sent)&&2e4===a.code){t.next=10;break}return t.abrupt("return",a);case 10:return s=a.data,J.a.setToken(s),t.next=14,this.props.authManage.getRoleById({id:n.roles});case 14:if((c=t.sent)&&200===c.status){t.next=17;break}return t.abrupt("return",c);case 17:return o=c.data,p=o.reduce((function(t,e){return[].concat(z()(t),z()(e.powers))}),[]),t.next=21,this.props.authManage.getMenusById({id:p.map((function(t){return t.menuId}))});case 21:if((u=t.sent)&&200===u.status){t.next=24;break}return t.abrupt("return",u);case 24:return r=u.data,t.next=27,this.props.authManage.getPowerById({id:Array.from(new Set(p.reduce((function(t,e){return[].concat(z()(t),z()(e.powers))}),[])))});case 27:if((l=t.sent)&&200===l.status){t.next=30;break}return t.abrupt("return",l);case 30:return i=l.data,t.abrupt("return",{status:200,data:{userInfo:n,roles:o,menus:r,powers:i}});case 32:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"onRemember",value:function(t){this.setState({rememberPassword:t.target.checked})}},{key:"render",value:function(){var t=this;return console.log("render"),console.log(this.props.root.language),S.a.createElement(W.a,{name:"normal_login",className:"login-form",initialValues:{remember:!0},onFinish:this.onFinish},S.a.createElement("div",null,S.a.createElement(q,{name:"username",rules:[{max:12,message:"最大长度为12位字符"},{required:!0,whitespace:!0,message:"请输入用户名"}]},S.a.createElement(T.a,{size:"large",id:"username",placeholder:"admin/user",onPressEnter:function(){return t.onSubmit()}})),S.a.createElement(q,{name:"password",rules:[{required:!0,message:"请输入密码"},{max:18,message:"最大长度18个字符"}]},S.a.createElement(T.a,{size:"large",type:"password",placeholder:"123456/123456",onPressEnter:function(){return t.onSubmit()}})),S.a.createElement(q,null,S.a.createElement(P.a,{className:"submit-btn",size:"large",type:"primary",htmlType:"submit",loading:this.state.loading},this.state.loading?"请稍后":"登录"))))}}]),r}(S.a.Component),w()(r,"propTypes",{location:E.a.any,history:E.a.any,form:E.a.any,actions:E.a.any}),o=i))||o)||o,G=Object(F.g)(V),K=(n(1720),n(1721)),Q=n.n(K);function X(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(function(t){h()(o,t);var e,n=(e=o,function(){var t,n=y()(e);if(X()){var o=y()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return g()(this,t)});function o(t){var e;return a()(this,o),(e=n.call(this,t)).state={},e}return p()(o,[{key:"render",value:function(){return S.a.createElement("div",{className:"nothing"},S.a.createElement("img",{src:Q.a,alt:"暂无数据"}),this.props.message||S.a.createElement("div",null,"暂无数据"))}}]),o}(S.a.PureComponent)).propTypes={message:E.a.any};var tt=x.a.TabPane,et=function(t){h()(o,t);var e,n=(e=o,function(){var t,n=y()(e);if(Z()){var o=y()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return g()(this,t)});function o(t){var e;a()(this,o),e=n.call(this,t),w()(l()(e),"getcode",(function(t){var n=window.location.host,o=window.location.protocol,r=encodeURIComponent(o+"//"+n+"/hub"),i=encodeURIComponent("https://oapi.dingtalk.com/connect/oauth2/sns_authorize?appid="+t+"&response_type=code&scope=snsapi_login&state=STATE&redirect_uri="+r);if(1==e.ajaxCount){DDLogin({id:"code-contain",goto:i,style:"border:none;",width:"365",height:"400"});document.getElementById("code-contain")}void 0!==window.addEventListener?window.addEventListener("message",(function(n){e.handleMessage(n,t)}),!1):void 0!==window.attachEvent&&window.attachEvent("onmessage",(function(n){e.handleMessage(n,t)})),e.setState({appid:t,isLogging:!1})})),w()(l()(e),"handleMessage",(function(t,e){if("https://login.dingtalk.com"==t.origin){var n="https://oapi.dingtalk.com/connect/oauth2/sns_authorize?appid="+e+"&response_type=code&scope=snsapi_login&state=STATE&redirect_uri=&loginTmpCode="+t.data;window.location.href=n}})),w()(l()(e),"getAppid",(function(){e.ajaxCount+=1,e.setState({isLogging:!0}),window.addEventListener?window.addEventListener("onmessage",(function(){console.log("解除绑定")})):window.attachEvent("onmessage",(function(){console.log("解除绑定")})),C()({url:BSS_ADMIN_URL+"/mockapi/usermanage/dingtalk/front/info/",method:"post"}).then((function(t){if(200==t.status){var n=t.data.appid;e.getcode(n)}else e.ajaxCount<3?e.getAppid():confirm_result("error","获取appid失败",error.response.data.message)})).catch((function(t){e.ajaxCount<3?e.getAppid():confirm_result("error","获取appid失败",t.response.data.message)}))})),w()(l()(e),"callback",(function(t){console.log(t)})),e.ajaxCount=0;return e.state={isLogging:!0,loading_tip:"正在处理,请耐心等待",appid:void 0},e}return p()(o,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){}},{key:"render",value:function(){return S.a.createElement("div",{className:"page-login"},S.a.createElement("div",{className:"login-wap"},S.a.createElement("div",{className:"login-box"},S.a.createElement(x.a,{defaultActiveKey:"1",onChange:this.callback},S.a.createElement(tt,{tab:"钉钉扫码",key:"1"},S.a.createElement("div",{id:"code-contain"},S.a.createElement("span",null,"二维码"))),S.a.createElement(tt,{tab:"账号登录",key:"2"},S.a.createElement(G,null))))))}}]),o}(S.a.Component);w()(et,"propTypes",{location:E.a.any,history:E.a.any})}}]);