(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{1553:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return et}));a(172);var n,o,r,l,i=a(105),s=a.n(i),c=(a(152),a(78)),d=a.n(c),u=(a(47),a(17)),m=a.n(u),p=(a(98),a(55)),f=a.n(p),h=(a(60),a(12)),y=a.n(h),v=(a(254),a(116)),g=a.n(v),E=(a(173),a(84)),b=a.n(E),w=a(15),k=a.n(w),S=a(19),N=a.n(S),D=a(6),I=a.n(D),O=a(20),C=a.n(O),x=a(21),R=a.n(x),M=a(13),L=a.n(M),P=a(2),j=a.n(P),U=(a(58),a(11)),B=a.n(U),W=(a(65),a(25)),T=a.n(W),q=a(0),F=a.n(q),z=a(1),A=a.n(z),K=a(1596),G=a(1592),V=a(1589),J=a(1591),$=a(23),H=a(18),Q=a(9),X=a(28),Y=a(26),Z=a(52),ee=(a(171),a(89)),te=a.n(ee),ae=(a(724),a(417)),ne=a.n(ae),oe=(a(193),a(75)),re=a.n(oe),le=a(33),ie=a.n(le),se=(a(194),a(106)),ce=a.n(se),de=a(5),ue=a.n(de),me=a(153),pe=a(1629),fe=a(218),he=a.n(fe),ye=a(99);function ve(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ge,Ee,be,we=(n=Object($.b)("portDict"),Object(ye.g)(o=n(o=Object($.c)((l=r=function(e){C()(n,e);var t,a=(t=n,function(){var e,a=L()(t);if(ve()){var n=L()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return R()(this,e)});function n(e){var t;return k()(this,n),t=a.call(this,e),j()(I()(t),"formRefAdd",F.a.createRef()),j()(I()(t),"formRefEdit",F.a.createRef()),j()(I()(t),"onOk",(function(){t.props.onSelect(t.state.lists),t.setState({showModal:!1})})),j()(I()(t),"onClose",(function(){t.setState({showModal:!1})})),t.newDataLen=0,t.nowData={},t.state={nodeNum:t.props.nodeParam.nodeNum,sortWay:t.props.nodeParam.sortWay,lists:[],loading:!1,showModal:!1,showModalEdit:!1,Editloading:!1},t}return N()(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){}},{key:"modalShow",value:function(){var e=this.props.nodeParam,t=e.sortWay,a=e.nodeNum;if(null==t||null==a)return T.a.error({title:"请选择节点类型并输入节点数"}),!1;var n=this.state.lists;switch(t){case"0":n=[];for(var o=0;o<a;o++)n.push({id:null,index:o+1,node:o+1});break;case"1":n=[];for(var r=0;r<a;r++)n.push({id:null,index:r+1,node:String.fromCharCode(65+r)});break;case"2":if(null==this.state.nodeNum||this.state.sortWay!=t){n=[];for(var l=0;l<a;l++)n.push({id:null,index:l+1,node:void 0})}else{if(n=he()(this.state.lists),a>this.state.nodeNum)for(var i=this.state.nodeNum;i<a;i++)n.push({id:null,index:i+1,node:void 0});a<this.state.nodeNum&&n.splice(a,this.state.nodeNum)}}this.nowData=n,this.setState({showModal:!0,lists:n,nodeNum:a,sortWay:t})}},{key:"changeNodeName",value:function(e,t){if(new RegExp("-").test(e))T.a.error({title:"节点名称不允许有中划线-"});else{var a=he()(this.state.lists),n=a[t];a.splice(t,1,{index:n.index,id:n.id,node:e}),this.setState({lists:a})}}},{key:"makeColumns",value:function(){var e=this;return[{title:"序号",dataIndex:"index",width:150,key:"index"},{title:"节点编号",dataIndex:"node",width:150,key:"node",render:function(t,a,n){return F.a.createElement("div",null,F.a.createElement(f.a,{key:a.index,style:{width:"80%"},value:t,disabled:"2"!=e.props.nodeParam.sortWay,onChange:function(t){e.changeNodeName(t.target.value,n)}}))}}]}},{key:"render",value:function(){var e=this,t=this.state,a=t.lists,n=t.showModal,o=t.loading;return F.a.createElement("main",{className:"mian"},F.a.createElement(T.a,{title:this.props.title,maskClosable:!1,width:"90%",okText:"保存",cancelText:"取消",onOk:this.onOk,onCancel:this.onClose,visible:n},F.a.createElement("div",{className:"g-table"},F.a.createElement(d.a,{columns:this.makeColumns(),rowKey:function(e){return e.index},loading:o,dataSource:a}))),F.a.createElement("span",{onClick:function(){e.modalShow()}},this.props.children))}}]),n}(F.a.Component),j()(r,"propTypes",{location:A.a.any,history:A.a.any,match:A.a.any,portDict:A.a.any,powers:A.a.array,children:A.a.any,onSelect:A.a.func,title:A.a.string,nodeParam:A.a.any,onOk:A.a.func,onClose:A.a.func}),o=l))||o)||o)||o);function ke(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(a),!0).forEach((function(t){j()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ke(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ne(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var De,Ie,Oe,Ce=y.a.Item,xe=f.a.TextArea,Re=B.a.Option,Me=Object($.b)("nodeMasterDict")(ge=Object($.c)((be=Ee=function(e){C()(n,e);var t,a=(t=n,function(){var e,a=L()(t);if(Ne()){var n=L()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return R()(this,e)});function n(e){var t;return k()(this,n),t=a.call(this,e),j()(I()(t),"formRefAdd",F.a.createRef()),j()(I()(t),"onClose",(function(){t.props.onClose()})),j()(I()(t),"resetUw",(function(e){t.setState({uw:parseInt(e),ubitInfo:{},regionInfo:{},cabinetInfo:{},locationCode:void 0})})),j()(I()(t),"resetNode",(function(e,a){t.nodeParam[e]=a,t.setState()})),t.nodeParam={sortWay:void 0,nodeNum:"tempadd"==t.props.addType?t.props.defaultData.nodeNum:void 0},t.defaultData={},"tempadd"==t.props.addType&&(t.defaultData={deviceBrand:t.props.defaultData.deviceBrand,deviceModel:t.props.defaultData.deviceModel,deviceSpec:t.props.defaultData.deviceSpec,nodeNum:t.props.defaultData.nodeNum,remark:t.props.defaultData.remark,us:t.props.defaultData.us}),t.nodes=[],t.state={uw:"tempadd"==t.props.addType?t.props.defaultData.us:null,ubitInfo:{},regionInfo:{},cabinetInfo:{},locationCode:void 0,nodeList:[]},t}return N()(n,[{key:"onFinish",value:function(e){if(null!=this.state.ubitInfo.uw){var t=Se({locationId:this.state.regionInfo.fullLocationId,cabinetId:this.state.cabinetInfo.id,startUs:this.state.ubitInfo.uw},e);if("2"==e.sortWay){var a=[];ue.a.map(this.state.nodeList,(function(e){a.push({id:e.id,name:e.node})})),t=Se({},t,{nodeList:a})}this.props.onOk(t)}else T.a.error({title:"请选择U位"})}},{key:"onSelectUBit",value:function(e){var t=e.uBitInfo.uw+this.state.uw-1,a="".concat(e.regionInfo.fullLocationCode,"-").concat(e.cabinetInfo.row,"-").concat(e.cabinetInfo.coulmn,"-").concat(e.uBitInfo.uw,"-").concat(t);this.setState({ubitInfo:e.uBitInfo,regionInfo:e.regionInfo,cabinetInfo:e.cabinetInfo,locationCode:a})}},{key:"saveNode",value:function(e){this.setState({nodeList:e})}},{key:"render",value:function(){var e=this,t=this.state,a=t.uw,n=t.regionInfo,o=t.cabinetInfo,r=t.locationCode,l=t.nodeList;return F.a.createElement(F.a.Fragment,null,F.a.createElement(y.a,{name:"form_in_modal",ref:this.formRefAdd,className:"g-modal-field",initialValues:this.defaultData,onFinish:function(t){e.onFinish(t)},validateMessages:{required:"'${name}' 是必选字段"}},F.a.createElement(te.a,null,F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ce,ie()({label:F.a.createElement("span",{className:"required"}," 节点数"),style:{marginBottom:0}},X.a),F.a.createElement(y.a.Item,{name:"sortWay",rules:[{required:!0,message:"请选择节点类型"}],style:{display:"inline-block",width:120}},F.a.createElement(B.a,{placeholder:"节点类型",onChange:function(t){e.resetNode("sortWay",t)}},F.a.createElement(Re,{value:"0"},"数字 (1)"),F.a.createElement(Re,{value:"1"},"字母 (A)"),F.a.createElement(Re,{value:"2"},"自定义"))),F.a.createElement(y.a.Item,{name:"nodeNum",rules:[{required:!0,message:"请输入节点数"}],style:{display:"inline-block",width:100}},F.a.createElement(ce.a,{placeholder:"节点数",maxLength:2,onChange:function(t){e.resetNode("nodeNum",t)},rules:[{required:!0}]})),F.a.createElement("div",{style:{display:"inline-block",width:100}},F.a.createElement(we,{nodeParam:this.nodeParam,title:"节点编号",lists:l,onSelect:function(t){e.saveNode(t)}},F.a.createElement(m.a,{type:"primary"},"节点编号"))))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ce,ie()({label:F.a.createElement("span",{className:"required"}," U位"),style:{marginBottom:0}},X.a),F.a.createElement(Ce,{name:"us",rules:[{required:!0,pattern:me.a.num,message:"请输入数字"}],style:{display:"inline-block",width:100}},F.a.createElement(ce.a,{onChange:this.resetUw})),F.a.createElement(pe.a,{uw:a,title:"选择U位",onSelect:function(t){e.onSelectUBit(t)}},F.a.createElement(m.a,{style:{width:120},disabled:!a,type:"primary"},"选择U位")))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ce,ie()({label:F.a.createElement("span",{className:"required"}," 区域")},X.a),F.a.createElement(f.a,{placeholder:"地区/机房/区域(自动生成)",type:"text",disabled:!0,value:n.fullLocationName}))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ce,ie()({label:F.a.createElement("span",{className:"required"}," 机柜")},X.a),F.a.createElement(f.a,{placeholder:"自动生成",type:"text",disabled:!0,value:o.name}))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ce,ie()({label:F.a.createElement("span",{className:"required"}," 位置码")},X.a),F.a.createElement(f.a,{placeholder:"自动生成",type:"text",disabled:!0,value:r}))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ce,ie()({label:"设备品牌",name:"deviceBrand",rules:[{required:!0,message:"请选择"}]},X.a),F.a.createElement(B.a,null,ue.a.map(this.props.nodeMasterDict.device_brand,(function(e,t){return F.a.createElement(Re,{value:parseInt(t),key:t}," ",e," ")}))))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ce,ie()({label:"设备型号",name:"deviceModel",rules:[{required:!0,message:"请选择"}]},X.a),F.a.createElement(B.a,null,ue.a.map(this.props.nodeMasterDict.device_model,(function(e,t){return F.a.createElement(Re,{value:parseInt(t),key:t}," ",e," ")}))))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ce,ie()({label:"采购时间",name:"purchasingTime",rules:[{required:!0,message:"请选择"}]},X.a),F.a.createElement(ne.a,{style:{width:"100%"}}))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(y.a.Item,ie()({name:"deviceSpec",label:"规格",rules:[{required:!0,message:"请选择规格"}]},X.a),F.a.createElement(B.a,null,ue.a.map(this.props.nodeMasterDict.device_spec,(function(e,t){return F.a.createElement(Re,{value:parseInt(t),key:t}," ",e," ")}))))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:24,xl:24},F.a.createElement(Ce,ie()({label:"备注",name:"remark"},X.b),F.a.createElement(xe,{autoSize:{minRows:5},placeholder:"请输入",maxLength:250})))),F.a.createElement("div",{className:"actions-btn"},F.a.createElement(m.a,{htmlType:"submit",className:"action-btn ok"},"确认提交"),F.a.createElement(m.a,{onClick:this.onClose,className:"action-btn ok"},"取消"))))}}]),n}(F.a.Component),j()(Ee,"propTypes",{location:A.a.any,history:A.a.any,nodeMasterDict:A.a.any,powers:A.a.array,onOk:A.a.func,onClose:A.a.func,defaultData:A.a.any,addType:A.a.string}),ge=be))||ge)||ge;function Le(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Pe,_e,je,Ue=Object(ye.g)(De=Object($.c)((Oe=Ie=function(e){C()(n,e);var t,a=(t=n,function(){var e,a=L()(t);if(Le()){var n=L()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return R()(this,e)});function n(e){var t;return k()(this,n),t=a.call(this,e),j()(I()(t),"formRefAddNode",F.a.createRef()),j()(I()(t),"formRefEditNode",F.a.createRef()),j()(I()(t),"onOk",(function(){t.props.onSelect(t.state.lists),t.setState({showModal:!1})})),j()(I()(t),"onClose",(function(){t.setState({showModal:!1})})),t.portkeys={},t.newDataLen=0,t.sortWay=t.props.nodeParam.sortWay,t.nodeNum=t.props.nodeParam.nodeNum,t.state={lists:t.props.defaultValues,loading:!1,showModal:!1,showModalEdit:!1,Editloading:!1,lastNum:t.props.nodeParam.nodeNum},t}return N()(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){}},{key:"modalShow",value:function(){var e=this.props.nodeParam,t=e.sortWay,a=e.nodeNum;if(null==t||null==a)return T.a.error({title:"请选择节点类型并输入节点数"}),!1;var n=he()(this.state.lists);switch(t){case"0":n=[];for(var o=0;o<a;o++)n.push({name:o+1,id:null});break;case"1":n=[];for(var r=0;r<a;r++)n.push({name:String.fromCharCode(65+r),id:null});break;case"2":if(this.nodeNum<=a&&a!==this.state.lastNum)if(a<this.state.lastNum)n.splice(a,this.state.lastNum-a);else if(a>this.state.lastNum)for(var l=this.state.lastNum;l<a;l++)n.push({name:void 0,id:null})}this.setState({showModal:!0,lists:n,lastNum:a})}},{key:"changeNodeName",value:function(e,t){if(new RegExp("-").test(e))T.a.error({title:"节点名称不允许有中划线-"});else{var a=he()(this.state.lists),n=a[t];a.splice(t,1,{name:e,id:n.id}),this.setState({lists:a})}}},{key:"makeColumns",value:function(){var e=this;return[{title:"序号",dataIndex:"index",width:150,key:"index",render:function(e,t,a){return a+1}},{title:"节点编号",dataIndex:"name",width:150,key:"name",render:function(t,a,n){return F.a.createElement("div",null,F.a.createElement(f.a,{style:{width:"80%"},value:t,disabled:"2"!=e.props.nodeParam.sortWay,onChange:function(t){e.changeNodeName(t.target.value,n,a)}}))}}]}},{key:"render",value:function(){var e=this,t=this.state,a=t.lists,n=t.showModal,o=t.loading;return F.a.createElement("main",{className:"mian"},F.a.createElement(T.a,{title:this.props.title,maskClosable:!1,width:"90%",destroyOnClose:!0,okText:"保存",onOk:this.onOk,onCancel:this.onClose,visible:n},F.a.createElement("div",{className:"g-table"},F.a.createElement(d.a,{columns:this.makeColumns(),rowKey:function(e){return e.index},loading:o,dataSource:a}))),F.a.createElement("span",{onClick:function(){e.modalShow()}},this.props.children))}}]),n}(F.a.Component),j()(Ie,"propTypes",{location:A.a.any,history:A.a.any,match:A.a.any,defaultValues:A.a.any,children:A.a.array,onSelect:A.a.func,title:A.a.string,nodeParam:A.a.any,onOk:A.a.func,onClose:A.a.func}),De=Oe))||De)||De,Be=a(1674);function We(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Te(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?We(Object(a),!0).forEach((function(t){j()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):We(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function qe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Fe,ze,Ae,Ke=y.a.Item,Ge=f.a.TextArea,Ve=B.a.Option,Je=Object($.b)("root")(Pe=Object($.b)("nodeMasterDict")(Pe=Object($.c)((je=_e=function(e){C()(n,e);var t,a=(t=n,function(){var e,a=L()(t);if(qe()){var n=L()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return R()(this,e)});function n(e){var t;return k()(this,n),t=a.call(this,e),j()(I()(t),"formRefEdit",F.a.createRef()),j()(I()(t),"onResetSearch",(function(){t.formRefEdit.current.resetFields()})),j()(I()(t),"onShowNodeModal",(function(){t.setState({showNodeModal:!0})})),j()(I()(t),"onCloseNode",(function(){t.setState({showNodeModal:!1})})),j()(I()(t),"resetUw",(function(e){var a=e;a!=t.state.uw&&t.setState({resetUw:!0,uw:parseInt(a),ubitInfo:{},regionInfo:{},cabinetInfo:{},locationCode:void 0,fullLocationName:void 0,cabinetName:void 0})})),j()(I()(t),"resetNode",(function(e,a){"sortWay"==e&&t.state.nodeNumDisabled&&t.setState({nodeNumDisabled:!1}),t.nodeParam[e]=a})),t.nodeParam={sortWay:t.props.defaultData.sortWay,nodeNum:t.props.defaultData.nodeNum},t.devideDetail=t.props.defaultData,t.nodes=[],t.props.defaultData.nodeServerDetailList&&t.props.defaultData.nodeServerDetailList.length>0&&ue.a.map(t.props.defaultData.nodeServerDetailList,(function(e,a){t.nodes.push({node:e.node,id:e.id})})),t.state={nodeNumDisabled:void 0===t.props.defaultData.sortWay,showNodeModal:!1,resetUw:!1,modalLoading:!1,uw:t.props.defaultData.us,ubitInfo:{uw:t.props.defaultData.startUs},regionInfo:{},cabinetInfo:{},locationCode:t.props.defaultData.positionalCode,fullLocationName:t.props.defaultData.locationName,cabinetName:t.props.defaultData.cabinetName},t}return N()(n,[{key:"componentDidMount",value:function(){}},{key:"onFinish",value:function(e){if(null!=this.state.ubitInfo.uw){var t=Te({sortWay:null},e,{version:this.props.defaultData.version});"2"==t.sortWay&&(t=Te({},t,{nodeList:this.nodes})),this.state.resetUw&&(t=Te({},t,{locationId:this.state.regionInfo.fullLocationId,cabinetId:this.state.cabinetInfo.id,startubat:this.state.ubitInfo.uw})),this.props.onOk(t)}else T.a.error({title:"请选择U位"})}},{key:"onSelectUBit",value:function(e){var t=e.uBitInfo.uw+this.state.uw-1,a="".concat(e.regionInfo.fullLocationCode,"-").concat(e.cabinetInfo.row,"-").concat(e.cabinetInfo.coulmn,"-").concat(e.uBitInfo.uw,"-").concat(t);this.setState({ubitInfo:e.uBitInfo,regionInfo:e.regionInfo,cabinetInfo:e.cabinetInfo,locationCode:a,fullLocationName:e.regionInfo.fullLocationName,cabinetName:e.cabinetInfo.name})}},{key:"saveNode",value:function(e){this.nodes=e}},{key:"render",value:function(){var e=this,t=this.props.nodeMasterDict,a=t.device_spec,n=t.device_brand,o=t.device_model,r=this.state,l=r.uw,i=r.locationCode,s=r.fullLocationName,c=r.cabinetName;return console.log(this.nodeParam.sortWay),F.a.createElement(F.a.Fragment,null,F.a.createElement(y.a,{name:"form_in_modal",ref:this.formRefEdit,className:"g-modal-field",initialValues:this.devideDetail,onFinish:function(t){e.onFinish(t)},validateMessages:{required:"'${name}' 是必选字段"}},F.a.createElement(te.a,null,F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ke,ie()({label:F.a.createElement("span",{className:"required"}," 节点数"),style:{marginBottom:0}},X.a),F.a.createElement(y.a.Item,{name:"sortWay",style:{display:"inline-block",width:100}},F.a.createElement(B.a,{placeholder:"节点类型",disabled:1==this.devideDetail.status,onChange:function(t){e.resetNode("sortWay",t)}},F.a.createElement(Ve,{value:"0"},"数字 (1)"),F.a.createElement(Ve,{value:"1"},"字母 (A)"),F.a.createElement(Ve,{value:"2"},"自定义"))),F.a.createElement(y.a.Item,{name:"nodeNum",disabled:1==this.devideDetail.status,rules:[{required:!0,message:"请输入节点数"}],style:{display:"inline-block",width:100}},F.a.createElement(ce.a,{placeholder:"节点数",maxLength:2,onChange:function(t){e.resetNode("nodeNum",t)},disabled:this.state.nodeNumDisabled})),F.a.createElement(m.a,{style:{display:"inline-block",width:80,marginRight:10},onClick:this.onShowNodeModal,type:"primary"},"修改节点"),F.a.createElement("div",{style:{display:"inline-block",width:80}},F.a.createElement(Ue,{nodeParam:this.nodeParam,defaultValues:this.nodes,title:"节点编号",onSelect:function(t){e.saveNode(t)}},F.a.createElement(m.a,{type:"primary"},"节点编号"))))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ke,ie()({label:F.a.createElement("span",{className:"required"}," U位"),style:{marginBottom:0}},X.a),F.a.createElement(Ke,{name:"us",rules:[{required:!0,pattern:me.a.num,message:"请输入数字"}],style:{display:"inline-block",width:100}},F.a.createElement(ce.a,{disabled:1==this.devideDetail.status,onChange:this.resetUw})),F.a.createElement(pe.a,{uw:l,title:"选择U位",onSelect:function(t){e.onSelectUBit(t)}},F.a.createElement(m.a,{style:{width:120},disabled:!l,type:"primary"},"选择U位")))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ke,ie()({label:F.a.createElement("span",{className:"required"}," 区域")},X.a),F.a.createElement(f.a,{placeholder:"地区/机房/区域(自动生成)",type:"text",disabled:!0,value:s}))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ke,ie()({label:F.a.createElement("span",{className:"required"}," 机柜")},X.a),F.a.createElement(f.a,{placeholder:"自动生成",type:"text",disabled:!0,value:c}))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ke,ie()({label:F.a.createElement("span",{className:"required"}," 位置码")},X.a),F.a.createElement(f.a,{placeholder:"自动生成",type:"text",disabled:!0,value:i}))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ke,ie()({label:"设备品牌",name:"deviceBrand",rules:[{required:!0}]},X.a),F.a.createElement(B.a,{disabled:1==this.devideDetail.status},ue.a.map(n,(function(e,t){return F.a.createElement(Ve,{value:parseInt(t),key:t}," ",e," ")}))))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(Ke,ie()({label:"设备型号",name:"deviceModel",rules:[{required:!0}]},X.a),F.a.createElement(B.a,{disabled:1==this.devideDetail.status},ue.a.map(o,(function(e,t){return F.a.createElement(Ve,{value:parseInt(t),key:t}," ",e," ")}))))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:12,xl:12},F.a.createElement(y.a.Item,ie()({name:"deviceSpec",label:"规格",rules:[{required:!0,message:"请选择规格"}]},X.a),F.a.createElement(B.a,{disabled:1==this.devideDetail.status},ue.a.map(a,(function(e,t){return F.a.createElement(Ve,{value:parseInt(t),key:t}," ",e," ")}))))),F.a.createElement(re.a,{xs:24,sm:24,md:24,lg:24,xl:24},F.a.createElement(Ke,ie()({label:"备注",name:"remark"},X.b),F.a.createElement(Ge,{maxLength:250,autoSize:{minRows:5},placeholder:"请输入"})))),F.a.createElement("div",{className:"actions-btn"},F.a.createElement(m.a,{htmlType:"submit",className:"action-btn ok"},"确认提交"),F.a.createElement(m.a,{onClick:this.props.onClose,className:"action-btn ok"},"取消"))),F.a.createElement(T.a,{title:"节点信息",maskClosable:!1,width:"90%",destroyOnClose:!0,footer:null,onCancel:this.onCloseNode,visible:this.state.showNodeModal,modalLoading:this.state.modalLoading},F.a.createElement(Be.a,{canOpt:!0,nodeMasterId:this.props.defaultData.id,lists:this.devideDetail.nodeServerDetailList})))}}]),n}(F.a.Component),j()(_e,"propTypes",{location:A.a.any,history:A.a.any,children:A.a.any,root:A.a.any,nodeMasterDict:A.a.any,powers:A.a.array,onOk:A.a.func,defaultData:A.a.any,onClose:A.a.func,deviceId:A.a.string}),Pe=je))||Pe)||Pe)||Pe,$e=a(1672);function He(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Qe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?He(Object(a),!0).forEach((function(t){j()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):He(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Xe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ye=T.a.confirm,Ze=B.a.Option,et=Object($.b)("root")(Fe=Object($.b)("nodeMasterDict")(Fe=Object($.b)("areaResouse")(Fe=Object($.c)((Ae=ze=function(e){C()(n,e);var t,a=(t=n,function(){var e,a=L()(t);if(Xe()){var n=L()(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return R()(this,e)});function n(e){var t;return k()(this,n),t=a.call(this,e),j()(I()(t),"searchFormRef",F.a.createRef()),j()(I()(t),"onResetSearch",(function(){t.searchParam={},t.searchFormRef.current.resetFields()})),j()(I()(t),"onModalAddOk",(function(e){t.setState({modalLoading:!0});Q.a.clearNull(Qe({},e));H.a.post("".concat(BSS_ADMIN_URL,"/api/product/nodeserver/master/add"),Q.a.clearNull(e)).then((function(e){e=e.data,Q.a.hasStatusOk(e)?(Q.a.auto_close_result("ok","操作成功"),t.setState({page:1,modalLoading:!1,modalShow:!1}),t.onGetListData({page:1})):(t.setState({modalLoading:!1}),Q.a.dealFail(e))})).catch((function(){t.setState({modalLoading:!1})}))})),j()(I()(t),"onModalEditOk",(function(e){t.setState({modalLoading:!0});var a=Q.a.clearNull(Qe({},e));H.a.put("".concat(BSS_ADMIN_URL,"/api/product/nodeserver/master/").concat(t.state.nowDeviceId,"/update"),a).then((function(e){e=e.data,Q.a.hasStatusOk(e)?(Q.a.auto_close_result("ok","操作成功"),t.setState({modalLoading:!1,modalShowEdit:!1}),t.onGetListData()):(t.setState({modalLoading:!1}),Q.a.dealFail(e))})).catch((function(){t.setState({modalLoading:!1})}))})),j()(I()(t),"onModalClose",(function(){t.setState({modalShow:!1,modalShowEdit:!1})})),t.selectedRows=[],t.searchParam={},t.state={lists:[],loading:!1,page:1,pageSize:20,total:0,selectedRowKeys:[],modalShow:!1,modalLoading:!1,nowData:{},nowDeviceId:"",modalShowEdit:!1,addType:void 0},t}return N()(n,[{key:"componentDidMount",value:function(){this.onGetListData(),this.props.areaResouse.houseList.length<=0&&this.props.areaResouse.fetchHouse(),this.props.areaResouse.vareaList.length<=0&&this.props.areaResouse.fetchVarea(),Object.keys(this.props.nodeMasterDict.device_model).length<=0&&this.props.nodeMasterDict.fetchDeviceModel(),Object.keys(this.props.nodeMasterDict.device_spec).length<=0&&this.props.nodeMasterDict.fetchDeviceSpec(),Object.keys(this.props.nodeMasterDict.device_brand).length<=0&&this.props.nodeMasterDict.fetchDeviceBrand()}},{key:"makeColumns",value:function(){var e=this;return[{title:"外机名称",dataIndex:"name",key:"name"},{title:"区域",dataIndex:"locationName",key:"locationName"},{title:"品牌",dataIndex:"deviceBrand",key:"deviceBrand",width:110,render:function(t,a,n){return e.props.nodeMasterDict.device_brand[t]||"UNKNOW"}},{title:"型号",dataIndex:"deviceModel",key:"deviceModel",render:function(t,a,n){return e.props.nodeMasterDict.device_model[t]||"UNKNOW"}},{title:"规格",dataIndex:"deviceSpec",key:"deviceSpec",width:90,render:function(t,a,n){return e.props.nodeMasterDict.device_spec[t]||"UNKNOW"}},{title:"机柜",dataIndex:"cabinetName",key:"cabinetName"},{title:"起始U位",dataIndex:"startUs",width:90,key:"startUs"},{title:"占用U位",dataIndex:"us",width:90,key:"us"},{title:"节点数",dataIndex:"nodeNum",width:80,key:"nodeNum"},{title:"销售状态",dataIndex:"status",width:90,key:"status",render:function(e){return Q.a.renderStatus(Y.g.node_server_market,e)}},{title:"资源备注",dataIndex:"remark",key:"remark"},{title:"操作",key:"control",fixed:"right",width:120,render:function(t,a){var n=[];n.push(F.a.createElement("span",{key:"0",className:"control-btn green"},F.a.createElement(b.a,{placement:"top",title:"查看"},F.a.createElement($e.a,{deviceId:a.id},F.a.createElement(K.a,null))))),Z.a.hasPermission("node-server-edit")&&n.push(F.a.createElement("span",{key:"1",className:"control-btn blue"},F.a.createElement(b.a,{placement:"top",title:"修改"},F.a.createElement(G.a,{onClick:function(){e.onModalShowEdit(a)}})))),Z.a.hasPermission("node-server-delete")&&n.push(F.a.createElement("span",{className:"control-btn red"},F.a.createElement(b.a,{placement:"top",title:"出库"},F.a.createElement(V.a,{onClick:function(){e.onDel(a.id)}}))));var o=[];return n.forEach((function(e,t){t&&o.push(F.a.createElement(g.a,{key:"line".concat(t),type:"vertical"})),o.push(e)})),o}}]}},{key:"onGetListData",value:function(e){var t=this,a=_.assign({},{page:this.state.page,pageSize:this.state.pageSize},this.searchParam,Qe({},e));this.setState({loading:!0}),H.a.get("".concat(BSS_ADMIN_URL,"/api/product/nodeserver/master"),{params:Q.a.clearEmpty(a)}).then((function(e){e=e.data,Q.a.hasStatusOk(e)?(t.selectedRows=[],t.setState({lists:e.data.records,selectedRowKeys:[],total:e.data.total})):Q.a.dealFail(e),t.setState({loading:!1})})).catch((function(){t.setState({loading:!1})}))}},{key:"onSearch",value:function(e){this.searchParam=e,this.setState({page:1}),this.onGetListData(e)}},{key:"onPageChange",value:function(e,t){this.setState({page:e}),this.onGetListData({page:e,pageSize:t})}},{key:"onPageSizeChange",value:function(e,t){this.setState({page:e,pageSize:t}),this.onGetListData({page:e,pageSize:t})}},{key:"onModalShow",value:function(e){if("tempadd"==e&&1!=this.selectedRows.length)return T.a.warning({title:"请选择一条数据作为模板"}),!1;this.setState({addType:e,modalShow:!0})}},{key:"onModalOk",value:function(e){var t=this;this.setState({modalLoading:!0}),H.a.post("".concat(BSS_ADMIN_URL,"/api/product/nodeServerMaster/add"),Q.a.clearNull(e)).then((function(e){e=e.data,Q.a.hasStatusOk(e)?(Q.a.auto_close_result("ok","操作成功"),t.setState({modalLoading:!1,modalShow:!1}),t.onGetListData()):(t.setState({modalLoading:!1}),Q.a.dealFail(e))})).catch((function(){t.setState({modalLoading:!1})}))}},{key:"getDetail",value:function(e){var t=this;this.setState({loading:!0}),H.a.get("".concat(BSS_ADMIN_URL,"/api/product/nodeserver/master/").concat(e,"/get")).then((function(a){if(a=a.data,Q.a.hasStatusOk(a)){var n=a.data;t.setState({modalShowEdit:!0,nowDeviceId:e,nowData:n,loading:!1})}else Q.a.dealFail(a),t.setState({loading:!1})})).catch((function(){t.setState({loading:!1})}))}},{key:"onDel",value:function(e){var t=this;Ye({icon:F.a.createElement(J.a,null),content:"确认要删除这条数据吗？",okText:"确定",cancelText:"取消",onOk:function(){t.setState({loading:!0}),H.a.delete("".concat(BSS_ADMIN_URL,"/api/product/nodeserver/master/").concat(e,"/delete")).then((function(e){e=e.data,Q.a.hasStatusOk(e)?(Q.a.auto_close_result("ok","操作成功"),t.onGetListData()):(Q.a.dealFail(e),t.setState({loading:!1}))})).catch((function(){t.setState({loading:!1})}))},onCancel:function(){console.log("Cancel")}})}},{key:"onBatchDel",value:function(){var e=this;this.selectedRows.length<=0?T.a.warning({title:"请至少选择一条数据！"}):Ye({icon:F.a.createElement(J.a,null),content:"确认执行批量删除操作吗？",okText:"确定",cancelText:"取消",onOk:function(){var t=[];_.map(e.selectedRows,(function(e){t.push(e.id)})),e.setState({loading:!0}),H.a.delete("".concat(BSS_ADMIN_URL,"/api/product/nodeserver/master/allDel"),{data:t}).then((function(t){t=t.data,Q.a.hasStatusOk(t)?(Q.a.auto_close_result("ok","操作成功"),e.onGetListData()):(Q.a.dealFail(t),e.setState({loading:!1}))})).catch((function(){e.setState({loading:!1})}))},onCancel:function(){console.log("Cancel")}})}},{key:"selectedRow",value:function(e,t){this.selectedRows=t,this.setState({selectedRowKeys:e})}},{key:"onModalShowEdit",value:function(e){this.getDetail(e.id)}},{key:"render",value:function(){var e=this,t=this.props.nodeMasterDict,a=t.device_model,n=t.device_spec,o=this.props.areaResouse,r=o.houseList,l=o.vareaList,i=this.state,c=i.lists,u=i.loading,p=i.page,h=i.pageSize,v=i.total,g=i.nowDeviceId,E=i.nowData;return F.a.createElement("main",{className:"mian"},F.a.createElement("div",{className:"g-search"},F.a.createElement(y.a,{ref:this.searchFormRef,name:"searchbox",layout:"inline",onFinish:function(t){e.onSearch(t)}},F.a.createElement(y.a.Item,{name:"houseId"},F.a.createElement(B.a,{allowClear:!0,placeholder:"请选择机房",style:{width:300},showSearch:!0,filterOption:Q.a.filterOption},r.map((function(e){return F.a.createElement(Ze,{value:e.id,key:e.id},e.fullName)})))),F.a.createElement(y.a.Item,{name:"locationId"},F.a.createElement(B.a,{allowClear:!0,placeholder:"请选择区域",style:{width:300},showSearch:!0,filterOption:Q.a.filterOption},l.map((function(e){return F.a.createElement(Ze,{value:e.fullLocationId,key:e.fullLocationId},e.fullLocationName)})))),F.a.createElement(y.a.Item,{name:"cabinetName"},F.a.createElement(f.a,{allowClear:!0,placeholder:"请选择机柜"})),F.a.createElement(y.a.Item,{name:"deviceModel"},F.a.createElement(B.a,{style:{width:200},placeholder:"外机型号",allowClear:!0},_.map(a,(function(e,t){return F.a.createElement(Ze,{value:parseInt(t),key:t}," ",e," ")})))),F.a.createElement(y.a.Item,{name:"deviceSpec"},F.a.createElement(B.a,{style:{width:200},placeholder:"外机规格",allowClear:!0},_.map(n,(function(e,t){return F.a.createElement(Ze,{value:parseInt(t),key:t}," ",e," ")})))),F.a.createElement(y.a.Item,{name:"status"},F.a.createElement(B.a,{style:{width:150},placeholder:"请选择销售状态",allowClear:!0},_.map(Y.g.node_server_market,(function(e,t){return F.a.createElement(Ze,{value:parseInt(t),key:t}," ",e.text," ")})))),F.a.createElement(y.a.Item,null,F.a.createElement(m.a,{type:"primary",htmlType:"submit"},"搜索")),F.a.createElement(y.a.Item,null,F.a.createElement(m.a,{type:"primary",onClick:this.onResetSearch},"重置")))),F.a.createElement("div",{className:"g-operate"},Z.a.hasPermission("node-server-delete")&&F.a.createElement(m.a,{className:"actions-btn",size:"middle",onClick:function(){e.onBatchDel()}},"批量删除"),Z.a.hasPermission("node-server-add")&&F.a.createElement(m.a,{className:"actions-btn",size:"middle",onClick:function(){e.onModalShow("add")}},"外机入库"),Z.a.hasPermission("node-server-add")&&F.a.createElement(m.a,{className:"actions-btn",size:"middle",onClick:function(){e.onModalShow("tempadd")}},"模板入库")),F.a.createElement("div",{className:"g-table"},F.a.createElement(d.a,{scroll:{x:1400},columns:this.makeColumns(),rowKey:function(e){return e.id},loading:u,dataSource:c,pagination:!1,rowSelection:{type:"checkbox",selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,a){e.selectedRow(t,a)}}}),F.a.createElement("div",{className:"g-pagination"},F.a.createElement(s.a,{current:p,total:v,pageSize:h,showSizeChanger:!0,showTotal:function(e){return"共 ".concat(e," 条")},onChange:function(t,a){e.onPageChange(t,a)},onShowSizeChange:function(t,a){e.onPageSizeChange(t,a)}})),F.a.createElement(T.a,{title:"添加外机",maskClosable:!1,width:"80%",destroyOnClose:!0,footer:null,onCancel:this.onModalClose,visible:this.state.modalShow,modalLoading:this.state.modalLoading},F.a.createElement(Me,{defaultData:this.selectedRows[0],addType:this.state.addType,onOk:function(t){return e.onModalAddOk(t)},onClose:this.onModalClose})),F.a.createElement(T.a,{title:"修改外机",maskClosable:!1,width:"90%",destroyOnClose:!0,footer:null,onCancel:this.onModalClose,visible:this.state.modalShowEdit,modalLoading:this.state.modalLoading},F.a.createElement(Je,{deviceId:g,defaultData:E,onOk:function(t){return e.onModalEditOk(t)},onClose:this.onModalClose}))))}}]),n}(F.a.Component),j()(ze,"propTypes",{location:A.a.any,history:A.a.any,userinfo:A.a.any,powers:A.a.array,nodeMasterDict:A.a.any}),Fe=Ae))||Fe)||Fe)||Fe)||Fe}}]);